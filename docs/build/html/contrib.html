<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="description" name="name" />
<meta content="&quot;The Kornia.contrib module provides models and utilities for deep learning applications, including base models and the EfficientViT architecture. The module offers configurable, efficient Vision Transformer (ViT) models and tools to load and utilize pre-trained checkpoints, designed to be integrated into deep learning pipelines with PyTorch.&quot;" name="content" />

        <script async src="https://www.googletagmanager.com/gtag/js?id=G-YSCFZB2WDV"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            
            gtag('config', 'G-YSCFZB2WDV');
            
        </script>
    <link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="kornia.core" href="core.html" /><link rel="prev" title="kornia.color" href="color.html" />
        <link rel="canonical" href="https://kornia.readthedocs.io/contrib.html" />

    <link rel="shortcut icon" href="_static/kornia_logo_favicon.png"/><!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>kornia.contrib - Kornia</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/css/main.css?v=9b880210" />
    
    


<style>
  body {
    --color-code-background: #f0f0f0;
  --color-code-foreground: black;
  --color-sidebar-background: #3980F5;
  --color-sidebar-background-border: #3980F5;
  --color-sidebar-caption-text: white;
  --color-sidebar-link-text--top-level: white;
  --color-sidebar-link-text: white;
  --sidebar-caption-font-size: normal;
  --color-sidebar-item-background--hover:  #5dade2;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  --color-sidebar-background: #1a1c1e;
  --color-sidebar-background-border: #1a1c1e;
  --color-sidebar-caption-text: white;
  --color-sidebar-link-text--top-level: white;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  --color-sidebar-background: #1a1c1e;
  --color-sidebar-background-border: #1a1c1e;
  --color-sidebar-caption-text: white;
  --color-sidebar-link-text--top-level: white;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Kornia</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/img/kornia_logo_only_light.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/img/kornia_logo_only_dark.svg" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">GET STARTED</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="get-started/introduction.html">What is Kornia library ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="get-started/highlights.html">Highlighted Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="get-started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="get-started/about.html">About</a></li>
<li class="toctree-l1"><a class="reference external" href="https://kornia.github.io/tutorials/">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="get-started/multi-framework-support.html">Multi-Framework Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="get-started/training.html">Training API (experimental)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.luxonis.com/en/latest/pages/tutorials/creating-custom-nn-models/#kornia">OpenCV AI Kit</a></li>
<li class="toctree-l1"><a class="reference internal" href="get-started/governance.html">Kornia AI Organization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API REFERENCE</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="augmentation.html">kornia.augmentation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of kornia.augmentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="augmentation.auto.html">Automatic Augmentation Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="augmentation.base.html">Base Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="augmentation.container.html">Augmentation Containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="augmentation.module.html">Image Augmentations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="color.html">kornia.color</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">kornia.contrib</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">kornia.core</a></li>
<li class="toctree-l1"><a class="reference internal" href="enhance.html">kornia.enhance</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature.html">Local Features and Image Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="filters.html">kornia.filters</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="geometry.html">kornia.geometry</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of kornia.geometry</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="geometry.bbox.html">kornia.geometry.bbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.boxes.html">kornia.geometry.boxes</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.keypoints.html">kornia.geometry.keypoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.calibration.html">kornia.geometry.calibration</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="geometry.camera.html">kornia.geometry.camera</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of kornia.geometry.camera</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="geometry.camera.pinhole.html">Pinhole Camera</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry.camera.perspective.html">Perspective Camera</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry.camera.stereo.html">Stereo Camera</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="geometry.conversions.html">kornia.geometry.conversions</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.depth.html">kornia.geometry.depth</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.epipolar.html">kornia.geometry.epipolar</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.homography.html">kornia.geometry.homography</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.liegroup.html">kornia.geometry.liegroup</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.liegroup.html#lie-algebra">lie algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.liegroup.html#lie-group-and-lie-algebra">lie group and lie algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.linalg.html">kornia.geometry.linalg</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.line.html">kornia.geometry.line</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.quaternion.html">kornia.geometry.quaternion</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.solvers.html">kornia.geometry.solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.subpix.html">kornia.geometry.subpix</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.transform.html">kornia.geometry.transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.ransac.html">kornia.geometry.ransac</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="sensors.html">kornia.sensors</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of kornia.sensors</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="sensors.camera.html">kornia.sensors.camera</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="io.html">kornia.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="image.html">kornia.image</a></li>
<li class="toctree-l1"><a class="reference internal" href="losses.html">kornia.losses</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">kornia.metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="morphology.html">kornia.morphology</a></li>
<li class="toctree-l1"><a class="reference internal" href="nerf.html">kornia.nerf</a></li>
<li class="toctree-l1"><a class="reference internal" href="onnx.html">ONNXSequential: Chain Multiple ONNX Models with Ease</a></li>
<li class="toctree-l1"><a class="reference internal" href="tracking.html">kornia.tracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">kornia.testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">kornia.utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="x.html">kornia.x</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">KORNIA APPLICATIONS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="applications/intro.html">Computer Vision Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications/visual_prompting.html">Visual Prompting</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications/face_detection.html">Face Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications/image_augmentations.html">Image Augmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications/image_classification.html">Image Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications/image_matching.html">Image Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications/image_stitching.html">Image Stitching</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications/image_registration.html">Image Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications/image_denoising.html">Image Denoising</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications/semantic_segmentation.html">Semantic segmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications/object_detection.html">Object detection</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">KORNIA MODELS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="models/efficient_vit.html">EfficientViT</a></li>
<li class="toctree-l1"><a class="reference internal" href="models/rt_detr.html">Real-Time Detection Transformer (RT-DETR)</a></li>
<li class="toctree-l1"><a class="reference internal" href="models/segment_anything.html">Segment Anything (SAM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="models/mobile_sam.html">Faster Segment Anything (MobileSAM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="models/yunet.html">YuNet</a></li>
<li class="toctree-l1"><a class="reference internal" href="models/vit.html">Vision Transformer (ViT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="models/vit_mobile.html">MobileViT</a></li>
<li class="toctree-l1"><a class="reference internal" href="models/tiny_vit.html">TinyViT</a></li>
<li class="toctree-l1"><a class="reference internal" href="models/loftr.html">LoFTR (matching)</a></li>
<li class="toctree-l1"><a class="reference internal" href="models/defmo.html">DeFMO (video)</a></li>
<li class="toctree-l1"><a class="reference internal" href="models/hardnet.html">Hardnet (descriptor)</a></li>
<li class="toctree-l1"><a class="reference internal" href="models/affnet.html">Affnet (detection)</a></li>
<li class="toctree-l1"><a class="reference internal" href="models/sold2.html">SOLD2 (Line detection and matching)</a></li>
<li class="toctree-l1"><a class="reference internal" href="models/dexined.html">Dexined (edge detection)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SUPPORT</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/kornia/kornia/issues">Issue tracker</a></li>
<li class="toctree-l1"><a class="reference external" href="https://join.slack.com/t/kornia/shared_invite/zt-csobk21g-2AQRi~X9Uu6PLMuUZdvfjA">Slack community</a></li>
<li class="toctree-l1"><a class="reference external" href="https://librecv.org">LibreCV community</a></li>
<li class="toctree-l1"><a class="reference external" href="https://twitter.com/kornia_foss">Twitter @kornia_foss</a></li>
<li class="toctree-l1"><a class="reference internal" href="community/chinese.html">Kornia 社区</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.youtube.com/channel/UCI1SE1Ij2Fast5BSKxoa7Ag">Kornia Youtube</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.linkedin.com/company/kornia/">Kornia LinkedIn</a></li>
<li class="toctree-l1"><a class="reference external" href="https://kornia.org">Kornia AI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">COMMUNITY</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="community/contribute.html">Contribute to Kornia</a></li>
<li class="toctree-l1"><a class="reference internal" href="community/faqs.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="community/bibliography.html">Bibliography</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/contrib.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="kornia-contrib">
<h1>kornia.contrib<a class="headerlink" href="#kornia-contrib" title="Link to this heading">¶</a></h1>
<section id="models">
<h2>Models<a class="headerlink" href="#models" title="Link to this heading">¶</a></h2>
<section id="base">
<h3>Base<a class="headerlink" href="#base" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.models.base.ModelBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.base.</span></span><span class="sig-name descname"><span class="pre">ModelBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.base.ModelBase" title="Link to this definition">¶</a></dt>
<dd><p>Abstract model class with some utilities function.</p>
<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.base.ModelBase.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fullgraph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inductor'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.base.ModelBase.compile" title="Link to this definition">¶</a></dt>
<dd><p>Compile this Module’s forward using <a class="reference external" href="http://pytorch.org/docs/stable/generated/torch.compile.html#torch.compile" title="(in PyTorch v2.6)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.compile()</span></code></a>.</p>
<p>This Module’s <cite>__call__</cite> method is compiled and all arguments are passed as-is
to <a class="reference external" href="http://pytorch.org/docs/stable/generated/torch.compile.html#torch.compile" title="(in PyTorch v2.6)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.compile()</span></code></a>.</p>
<p>See <a class="reference external" href="http://pytorch.org/docs/stable/generated/torch.compile.html#torch.compile" title="(in PyTorch v2.6)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.compile()</span></code></a> for details on the arguments for this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.base.ModelBase" title="kornia.contrib.models.base.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelBase</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code></a>(<code class="docutils literal notranslate"><span class="pre">ModelConfig</span></code>)]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.base.ModelBase.from_config">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.base.ModelBase.from_config" title="Link to this definition">¶</a></dt>
<dd><p>Build/load the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code></a>(<code class="docutils literal notranslate"><span class="pre">ModelConfig</span></code>)</span>) – The specifications for the model be build/loaded</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.base.ModelBase" title="kornia.contrib.models.base.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelBase</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code></a>(<code class="docutils literal notranslate"><span class="pre">ModelConfig</span></code>)]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.base.ModelBase.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.base.ModelBase.load_checkpoint" title="Link to this definition">¶</a></dt>
<dd><p>Load checkpoint from a given url or file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checkpoint</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The url or filepath for the respective checkpoint</p></li>
<li><p><strong>device</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code></a>]</span>, <em>optional</em>) – The desired device to load the weights and move the model
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="efficientvit">
<h3>EfficientViT<a class="headerlink" href="#efficientvit" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.EfficientViT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.efficient_vit.</span></span><span class="sig-name descname"><span class="pre">EfficientViT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backbone</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.EfficientViT" title="Link to this definition">¶</a></dt>
<dd><p>EfficientViT backbone model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.EfficientViT.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backbone</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.EfficientViT.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.EfficientViT.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.EfficientViT.forward" title="Link to this definition">¶</a></dt>
<dd><p>Extract features from the input images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>images</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – input images tensor of shape <span class="math notranslate nohighlight">\((B, C, H, W)\)</span>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a dictionary containing the features.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.EfficientViT.from_config">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.EfficientViT.from_config" title="Link to this definition">¶</a></dt>
<dd><p>Build the EfficientViT model from a configuration object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.efficient_vit.EfficientViTConfig" title="kornia.contrib.models.efficient_vit.model.EfficientViTConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">EfficientViTConfig</span></code></a></span>) – EfficientViT configuration object. See <a class="reference internal" href="#kornia.contrib.models.efficient_vit.EfficientViTConfig" title="kornia.contrib.models.efficient_vit.EfficientViTConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">EfficientViTConfig</span></code></a>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the EfficientViT model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#kornia.contrib.models.efficient_vit.EfficientViT" title="kornia.contrib.models.efficient_vit.EfficientViT">EfficientViT</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.EfficientViT.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.EfficientViT.load_checkpoint" title="Link to this definition">¶</a></dt>
<dd><p>Load checkpoint from a given url or file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checkpoint</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The url or filepath for the respective checkpoint</p></li>
<li><p><strong>device</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code></a>]</span>, <em>optional</em>) – The desired device to load the weights and move the model
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.EfficientViTConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.efficient_vit.</span></span><span class="sig-name descname"><span class="pre">EfficientViTConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.EfficientViTConfig" title="Link to this definition">¶</a></dt>
<dd><p>Configuration to construct EfficientViT model.</p>
<p>Model weights can be loaded from a checkpoint URL or local path.
The model weights are hosted on HuggingFace’s model hub: <a class="reference external" href="https://huggingface.co/kornia">https://huggingface.co/kornia</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>checkpoint</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>, <em>optional</em>) – URL or local path of model weights.
Default:  <code class="code docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code></p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.EfficientViTConfig.checkpoint">
<span class="sig-name descname"><span class="pre">checkpoint</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#kornia.contrib.models.efficient_vit.EfficientViTConfig.checkpoint" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.EfficientViTConfig.from_pretrained">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_pretrained</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.EfficientViTConfig.from_pretrained" title="Link to this definition">¶</a></dt>
<dd><p>Return a configuration object from a pre-trained model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_type</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'b1'</span></code>, <code class="docutils literal notranslate"><span class="pre">'b2'</span></code>, <code class="docutils literal notranslate"><span class="pre">'b3'</span></code>]</span>) – model type, one of <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;b1&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;b2&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;b3&quot;</span></code>.</p></li>
<li><p><strong>resolution</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">224</span></code>, <code class="docutils literal notranslate"><span class="pre">256</span></code>, <code class="docutils literal notranslate"><span class="pre">288</span></code>]</span>) – input resolution, one of <code class="xref py py-obj docutils literal notranslate"><span class="pre">224</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">256</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">288</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.efficient_vit.EfficientViTConfig" title="kornia.contrib.models.efficient_vit.model.EfficientViTConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">EfficientViTConfig</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="backbones">
<h3>Backbones<a class="headerlink" href="#backbones" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.backbone.EfficientViTBackbone">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.efficient_vit.backbone.</span></span><span class="sig-name descname"><span class="pre">EfficientViTBackbone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bn2d'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hswish'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTBackbone" title="Link to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.backbone.EfficientViTBackbone.build_local_block">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">build_local_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_ratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fewer_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTBackbone.build_local_block" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.backbone.EfficientViTBackbone.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTBackbone.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.
:rtype: <span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_b0">
<span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.efficient_vit.backbone.</span></span><span class="sig-name descname"><span class="pre">efficientvit_backbone_b0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_b0" title="Link to this definition">¶</a></dt>
<dd><p>Create EfficientViT B0.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTBackbone" title="kornia.contrib.models.efficient_vit.backbone.EfficientViTBackbone"><code class="xref py py-class docutils literal notranslate"><span class="pre">EfficientViTBackbone</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_b1">
<span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.efficient_vit.backbone.</span></span><span class="sig-name descname"><span class="pre">efficientvit_backbone_b1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_b1" title="Link to this definition">¶</a></dt>
<dd><p>Create EfficientViT B1.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTBackbone" title="kornia.contrib.models.efficient_vit.backbone.EfficientViTBackbone"><code class="xref py py-class docutils literal notranslate"><span class="pre">EfficientViTBackbone</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_b2">
<span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.efficient_vit.backbone.</span></span><span class="sig-name descname"><span class="pre">efficientvit_backbone_b2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_b2" title="Link to this definition">¶</a></dt>
<dd><p>Create EfficientViT B2.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTBackbone" title="kornia.contrib.models.efficient_vit.backbone.EfficientViTBackbone"><code class="xref py py-class docutils literal notranslate"><span class="pre">EfficientViTBackbone</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_b3">
<span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.efficient_vit.backbone.</span></span><span class="sig-name descname"><span class="pre">efficientvit_backbone_b3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_b3" title="Link to this definition">¶</a></dt>
<dd><p>Create EfficientViT B3.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTBackbone" title="kornia.contrib.models.efficient_vit.backbone.EfficientViTBackbone"><code class="xref py py-class docutils literal notranslate"><span class="pre">EfficientViTBackbone</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.backbone.EfficientViTLargeBackbone">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.efficient_vit.backbone.</span></span><span class="sig-name descname"><span class="pre">EfficientViTLargeBackbone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bn2d'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gelu'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTLargeBackbone" title="Link to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.backbone.EfficientViTLargeBackbone.build_local_block">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">build_local_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_ratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fewer_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTLargeBackbone.build_local_block" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.backbone.EfficientViTLargeBackbone.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTLargeBackbone.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.
:rtype: <span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_l0">
<span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.efficient_vit.backbone.</span></span><span class="sig-name descname"><span class="pre">efficientvit_backbone_l0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_l0" title="Link to this definition">¶</a></dt>
<dd><p>Create EfficientViT L0.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTLargeBackbone" title="kornia.contrib.models.efficient_vit.backbone.EfficientViTLargeBackbone"><code class="xref py py-class docutils literal notranslate"><span class="pre">EfficientViTLargeBackbone</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_l1">
<span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.efficient_vit.backbone.</span></span><span class="sig-name descname"><span class="pre">efficientvit_backbone_l1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_l1" title="Link to this definition">¶</a></dt>
<dd><p>Create EfficientViT L.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTLargeBackbone" title="kornia.contrib.models.efficient_vit.backbone.EfficientViTLargeBackbone"><code class="xref py py-class docutils literal notranslate"><span class="pre">EfficientViTLargeBackbone</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_l2">
<span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.efficient_vit.backbone.</span></span><span class="sig-name descname"><span class="pre">efficientvit_backbone_l2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_l2" title="Link to this definition">¶</a></dt>
<dd><p>Create EfficientViT L2.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTLargeBackbone" title="kornia.contrib.models.efficient_vit.backbone.EfficientViTLargeBackbone"><code class="xref py py-class docutils literal notranslate"><span class="pre">EfficientViTLargeBackbone</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_l3">
<span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.efficient_vit.backbone.</span></span><span class="sig-name descname"><span class="pre">efficientvit_backbone_l3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_l3" title="Link to this definition">¶</a></dt>
<dd><p>Create EfficientViT L3.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTLargeBackbone" title="kornia.contrib.models.efficient_vit.backbone.EfficientViTLargeBackbone"><code class="xref py py-class docutils literal notranslate"><span class="pre">EfficientViTLargeBackbone</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="structures">
<h3>Structures<a class="headerlink" href="#structures" title="Link to this heading">¶</a></h3>
<dl class="py class" id="anchor-segmentationresults">
<dt class="sig sig-object py" id="kornia.contrib.models.SegmentationResults">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.</span></span><span class="sig-name descname"><span class="pre">SegmentationResults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.SegmentationResults" title="Link to this definition">¶</a></dt>
<dd><p>Encapsulate the results obtained by a Segmentation model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logits</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – Results logits with shape <span class="math notranslate nohighlight">\((B, C, H, W)\)</span>, where <span class="math notranslate nohighlight">\(C\)</span> refers to the number of predicted masks</p></li>
<li><p><strong>scores</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – The scores from the logits. Shape <span class="math notranslate nohighlight">\((B, C)\)</span></p></li>
<li><p><strong>mask_threshold</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>, <em>optional</em>) – The threshold value to generate the <cite>binary_masks</cite> from the <cite>logits</cite>
Default:  <code class="code docutils literal notranslate"><span class="pre">0.0</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="kornia.contrib.models.SegmentationResults.binary_masks">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">binary_masks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></em><a class="headerlink" href="#kornia.contrib.models.SegmentationResults.binary_masks" title="Link to this definition">¶</a></dt>
<dd><p>Binary mask generated from logits considering the mask_threshold.</p>
<p>Shape will be the same of logits <span class="math notranslate nohighlight">\((B, C, H, W)\)</span> where <span class="math notranslate nohighlight">\(C\)</span> is the number masks predicted.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you run <cite>original_res_logits</cite>, this will generate the masks
based on the original resolution logits.
Otherwise, this will use the low resolution logits (self.logits).</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.SegmentationResults.logits">
<span class="sig-name descname"><span class="pre">logits</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></em><a class="headerlink" href="#kornia.contrib.models.SegmentationResults.logits" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.SegmentationResults.mask_threshold">
<span class="sig-name descname"><span class="pre">mask_threshold</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#kornia.contrib.models.SegmentationResults.mask_threshold" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.SegmentationResults.original_res_logits">
<span class="sig-name descname"><span class="pre">original_res_logits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size_encoder</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.SegmentationResults.original_res_logits" title="Link to this definition">¶</a></dt>
<dd><p>Remove padding and upscale the logits to the original image size.</p>
<p>Resize to image encoder input -&gt; remove padding (bottom and right) -&gt; Resize to original size</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method set a internal <cite>original_res_logits</cite> which will be used if available for the binary masks.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – The size of the image input to the model, in (H, W) format. Used to remove padding.</p></li>
<li><p><strong>original_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – The original size of the image before resizing for input to the model, in (H, W) format.</p></li>
<li><p><strong>image_size_encoder</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>) – The size of the input image for image encoder, in (H, W) format. Used to resize the
logits back to encoder resolution before remove the padding.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Batched logits in <span class="math notranslate nohighlight">\((K, C, H, W)\)</span> format, where (H, W) is given by original_size.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.SegmentationResults.scores">
<span class="sig-name descname"><span class="pre">scores</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></em><a class="headerlink" href="#kornia.contrib.models.SegmentationResults.scores" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.SegmentationResults.squeeze">
<span class="sig-name descname"><span class="pre">squeeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.SegmentationResults.squeeze" title="Link to this definition">¶</a></dt>
<dd><p>Realize a squeeze for the dim given for all properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.SegmentationResults" title="kornia.contrib.models.structures.SegmentationResults"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentationResults</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.models.Prompts">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.</span></span><span class="sig-name descname"><span class="pre">Prompts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.Prompts" title="Link to this definition">¶</a></dt>
<dd><p>Encapsulate the prompts inputs for a Model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]]</span>, <em>optional</em>) – A tuple with the keypoints (coordinates x, y) and their respective labels. Shape <span class="math notranslate nohighlight">\((K, N, 2)\)</span> for
the keypoints, and <span class="math notranslate nohighlight">\((K, N)\)</span>
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>boxes</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>, <em>optional</em>) – Batched box inputs, with shape <span class="math notranslate nohighlight">\((K, 4)\)</span>. Expected to be into xyxy format.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>masks</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>, <em>optional</em>) – Batched mask prompts to the model with shape <span class="math notranslate nohighlight">\((K, 1, H, W)\)</span>
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.Prompts.boxes">
<span class="sig-name descname"><span class="pre">boxes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a><span class="pre">[</span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a><span class="pre">]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#kornia.contrib.models.Prompts.boxes" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="kornia.contrib.models.Prompts.keypoints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">keypoints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><a class="headerlink" href="#kornia.contrib.models.Prompts.keypoints" title="Link to this definition">¶</a></dt>
<dd><p>The keypoints from the <cite>points</cite>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="kornia.contrib.models.Prompts.keypoints_labels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">keypoints_labels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><a class="headerlink" href="#kornia.contrib.models.Prompts.keypoints_labels" title="Link to this definition">¶</a></dt>
<dd><p>The keypoints labels from the <cite>points</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.Prompts.masks">
<span class="sig-name descname"><span class="pre">masks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a><span class="pre">[</span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a><span class="pre">]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#kornia.contrib.models.Prompts.masks" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.Prompts.points">
<span class="sig-name descname"><span class="pre">points</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a><span class="pre">[</span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a><span class="pre">,</span> <a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#kornia.contrib.models.Prompts.points" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>
<section id="visualprompter">
<h2>VisualPrompter<a class="headerlink" href="#visualprompter" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.visual_prompter.VisualPrompter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.visual_prompter.</span></span><span class="sig-name descname"><span class="pre">VisualPrompter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.visual_prompter.VisualPrompter" title="Link to this definition">¶</a></dt>
<dd><p>Allow the user to run multiple query with multiple prompts for a model.</p>
<p>At the moment, we just support the SAM model. The model is loaded based on the given config.</p>
<p>For default the images are transformed to have their long side with size of the <cite>image_encoder.img_size</cite>. This
Prompter class ensure to transform the images and the prompts before prediction. Also, the image is passed
automatically for the method <cite>preprocess_image</cite>, which is responsible for normalize the image and pad it to have
the right size for the SAM model <span class="math notranslate nohighlight">\((\text{image_encoder.img_size}, \text{image_encoder.img_size})\)</span>. For
default the image is normalized by the mean and standard deviation of the SAM dataset values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#kornia.contrib.models.sam.SamConfig" title="kornia.contrib.models.sam.model.SamConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamConfig</span></code></a>]</span>, <em>optional</em>) – A model config to generate the model. Now just the SAM model is supported.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>device</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code></a>]</span>, <em>optional</em>) – The desired device to use the model.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>dtype</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code></a>]</span>, <em>optional</em>) – The desired dtype to use the model.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># prompter = VisualPrompter() # Will load the vit h for default</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># You can load a custom SAM type for modifying the config</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prompter</span> <span class="o">=</span> <span class="n">VisualPrompter</span><span class="p">(</span><span class="n">SamConfig</span><span class="p">(</span><span class="s1">&#39;vit_b&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prompter</span><span class="o">.</span><span class="n">set_image</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boxes</span> <span class="o">=</span> <span class="n">Boxes</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
<span class="gp">... </span>        <span class="p">[[[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]]],</span>
<span class="gp">... </span>        <span class="n">device</span><span class="o">=</span><span class="n">prompter</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span>
<span class="gp">... </span>   <span class="p">),</span>
<span class="gp">... </span>   <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;xyxy&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prediction</span> <span class="o">=</span> <span class="n">prompter</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">boxes</span><span class="o">=</span><span class="n">boxes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prediction</span><span class="o">.</span><span class="n">logits</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1, 3, 256, 256])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.visual_prompter.VisualPrompter.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fullgraph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inductor'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.visual_prompter.VisualPrompter.compile" title="Link to this definition">¶</a></dt>
<dd><p>Apply <cite>torch.compile(…)</cite>/dynamo API into the VisualPrompter API.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more information about the dynamo API check the official docs
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.compile.html">https://pytorch.org/docs/stable/generated/torch.compile.html</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fullgraph</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>, <em>optional</em>) – Whether it is ok to break model into several subgraphs
Default:  <code class="code docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>dynamic</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>, <em>optional</em>) – Use dynamic shape tracing
Default:  <code class="code docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>backend</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>, <em>optional</em>) – backend to be used
Default:  <code class="code docutils literal notranslate"><span class="pre">&quot;inductor&quot;</span></code></p></li>
<li><p><strong>mode</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>, <em>optional</em>) – Can be either “default”, “reduce-overhead” or “max-autotune”
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>options</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>, <em>optional</em>) – A dictionary of options to pass to the backend.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>disable</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>, <em>optional</em>) – Turn torch.compile() into a no-op for testing
Default:  <code class="code docutils literal notranslate"><span class="pre">False</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># prompter = VisualPrompter()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># prompter.compile() # You should have torch &gt;= 2.0.0 installed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use the prompter methods ...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.visual_prompter.VisualPrompter.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keypoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keypoints_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multimask_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_original_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.visual_prompter.VisualPrompter.predict" title="Link to this definition">¶</a></dt>
<dd><p>Predict masks for the given image based on the input prompts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keypoints</strong> (<span class="sphinx_autodoc_typehints-type">Optional[Keypoints | Tensor]</span>, <em>optional</em>) – Point prompts to the model. Each point is in (X,Y) in pixels. Shape <span class="math notranslate nohighlight">\((K, N, 2)\)</span>. Where
<cite>N</cite> is the number of points and <cite>K</cite> the number of prompts.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>keypoints_labels</strong> (<span class="sphinx_autodoc_typehints-type">Optional[Tensor]</span>, <em>optional</em>) – Labels for the point prompts. 1 indicates a foreground point and 0 indicates a background
point. Shape <span class="math notranslate nohighlight">\((K, N)\)</span>. Where <cite>N</cite> is the number of points, and <cite>K</cite> the number of
prompts.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>boxes</strong> (<span class="sphinx_autodoc_typehints-type">Optional[Boxes | Tensor]</span>, <em>optional</em>) – A box prompt to the model. If a tensor, should be in a xyxy mode. Shape <span class="math notranslate nohighlight">\((K, 4)\)</span>
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>masks</strong> (<span class="sphinx_autodoc_typehints-type">Optional[Tensor]</span>, <em>optional</em>) – A low resolution mask input to the model, typically coming from a previous prediction
iteration. Has shape <span class="math notranslate nohighlight">\((K, 1, H, W)\)</span>, where for SAM, H=W=256.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>multimask_output</strong> (<span class="sphinx_autodoc_typehints-type">bool</span>, <em>optional</em>) – If true, the model will return three masks. For ambiguous input prompts (such as a
single click), this will often produce better masks than a single prediction. If only
a single mask is needed, the model’s predicted quality score can be used to select the
best mask. For non-ambiguous prompts, such as multiple input prompts,
multimask_output=False can give better results.
Default:  <code class="code docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><strong>output_original_size</strong> (<span class="sphinx_autodoc_typehints-type">bool</span>, <em>optional</em>) – If true, the logits of <cite>SegmentationResults</cite> will be post-process to match the
original input image size.
Default:  <code class="code docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type">SegmentationResults</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A prediction with the logits and scores (IoU of each predicted mask)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.visual_prompter.VisualPrompter.preprocess_image">
<span class="sig-name descname"><span class="pre">preprocess_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.visual_prompter.VisualPrompter.preprocess_image" title="Link to this definition">¶</a></dt>
<dd><p>Normalize and pad a tensor.</p>
<p>For normalize the tensor: will prioritize the <cite>mean</cite> and <cite>std</cite> passed as argument, if None will use the default
Sam Dataset values.</p>
<p>For pad the tensor: Will pad the tensor into the right and bottom to match with the size of
<cite>self.model.image_encoder.img_size</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – The image to be preprocessed</p></li>
<li><p><strong>mean</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>, <em>optional</em>) – Mean for each channel.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>std</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>, <em>optional</em>) – Standard deviations for each channel.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The image preprocessed (normalized if has mean and str available and padded to encoder size)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.visual_prompter.VisualPrompter.preprocess_prompts">
<span class="sig-name descname"><span class="pre">preprocess_prompts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keypoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keypoints_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.visual_prompter.VisualPrompter.preprocess_prompts" title="Link to this definition">¶</a></dt>
<dd><p>Validate and preprocess the given prompts to be aligned with the input image.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type">Prompts</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.visual_prompter.VisualPrompter.set_image">
<span class="sig-name descname"><span class="pre">set_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.visual_prompter.VisualPrompter.set_image" title="Link to this definition">¶</a></dt>
<dd><p>Set the embeddings from the given image with <cite>image_decoder</cite> of the model.</p>
<p>Prepare the given image with the selected transforms and the preprocess method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – RGB image. Normally images with range of [0-1], the model preprocess normalize the
pixel values with the mean and std defined in its initialization. Expected to be into a float32
dtype. Shape <span class="math notranslate nohighlight">\((3, H, W)\)</span>.</p></li>
<li><p><strong>mean</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>, <em>optional</em>) – mean value of dataset for normalization.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>std</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>, <em>optional</em>) – standard deviation of dataset for normalization.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="edge-detection">
<h2>Edge Detection<a class="headerlink" href="#edge-detection" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.EdgeDetector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">EdgeDetector</span></span><a class="headerlink" href="#kornia.contrib.EdgeDetector" title="Link to this definition">¶</a></dt>
<dd><p>Detect edges in a given image using a CNN.</p>
<p>By default, it uses the method described in <span id="id1">[<a class="reference internal" href="community/bibliography.html#id25" title="X. Soria, E. Riba, and A. Sappa. Dense extreme inception network: towards a robust cnn model for edge detection. In 2020 IEEE Winter Conference on Applications of Computer Vision (WACV), volume, 1912-1921. Los Alamitos, CA, USA, mar 2020. IEEE Computer Society. URL: https://doi.ieeecomputersociety.org/10.1109/WACV45572.2020.9093290, doi:10.1109/WACV45572.2020.9093290.">SRS20</a>]</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tensor of shape <span class="math notranslate nohighlight">\((B,1,H,W)\)</span>.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">320</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detect</span> <span class="o">=</span> <span class="n">EdgeDetector</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">detect</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1, 1, 320, 320])</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="face-detection">
<h2>Face Detection<a class="headerlink" href="#face-detection" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.FaceDetector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">FaceDetector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nms_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">750</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.FaceDetector" title="Link to this definition">¶</a></dt>
<dd><p>Detect faces in a given image using a CNN.</p>
<p>By default, it uses the method described in <span id="id2">[<a class="reference internal" href="community/bibliography.html#id24" title="Yuantao Feng, Shiqi Yu, Hanyang Peng, Yan-ran Li, and Jianguo Zhang. Detect faces efficiently: a survey and evaluations. IEEE Transactions on Biometrics, Behavior, and Identity Science, 2021.">FYP+21</a>]</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>top_k</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>, <em>optional</em>) – the maximum number of detections to return before the nms.
Default:  <code class="code docutils literal notranslate"><span class="pre">5000</span></code></p></li>
<li><p><strong>confidence_threshold</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>, <em>optional</em>) – the threshold used to discard detections.
Default:  <code class="code docutils literal notranslate"><span class="pre">0.3</span></code></p></li>
<li><p><strong>nms_threshold</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>, <em>optional</em>) – the threshold used by the nms for iou.
Default:  <code class="code docutils literal notranslate"><span class="pre">0.3</span></code></p></li>
<li><p><strong>keep_top_k</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>, <em>optional</em>) – the maximum number of detections to return after the nms.
Default:  <code class="code docutils literal notranslate"><span class="pre">750</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of B tensors with shape <span class="math notranslate nohighlight">\((N,15)\)</span> to be used with <a class="reference internal" href="#kornia.contrib.FaceDetectorResult" title="kornia.contrib.FaceDetectorResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">kornia.contrib.FaceDetectorResult</span></code></a>.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">320</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detect</span> <span class="o">=</span> <span class="n">FaceDetector</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">detect</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.FaceKeypoint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">FaceKeypoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.FaceKeypoint" title="Link to this definition">¶</a></dt>
<dd><p>Define the keypoints detected in a face.</p>
<p>The left/right convention is based on the screen viewer.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.FaceKeypoint.EYE_LEFT">
<span class="sig-name descname"><span class="pre">EYE_LEFT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#kornia.contrib.FaceKeypoint.EYE_LEFT" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.FaceKeypoint.EYE_RIGHT">
<span class="sig-name descname"><span class="pre">EYE_RIGHT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#kornia.contrib.FaceKeypoint.EYE_RIGHT" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.FaceKeypoint.MOUTH_LEFT">
<span class="sig-name descname"><span class="pre">MOUTH_LEFT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#kornia.contrib.FaceKeypoint.MOUTH_LEFT" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.FaceKeypoint.MOUTH_RIGHT">
<span class="sig-name descname"><span class="pre">MOUTH_RIGHT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#kornia.contrib.FaceKeypoint.MOUTH_RIGHT" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.FaceKeypoint.NOSE">
<span class="sig-name descname"><span class="pre">NOSE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#kornia.contrib.FaceKeypoint.NOSE" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.FaceDetectorResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">FaceDetectorResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.FaceDetectorResult" title="Link to this definition">¶</a></dt>
<dd><p>Encapsulate the results obtained by the <a class="reference internal" href="#kornia.contrib.FaceDetector" title="kornia.contrib.FaceDetector"><code class="xref py py-class docutils literal notranslate"><span class="pre">kornia.contrib.FaceDetector</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – the encoded results coming from the feature detector with shape <span class="math notranslate nohighlight">\((14,)\)</span>.</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="kornia.contrib.FaceDetectorResult.bottom_left">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bottom_left</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></em><a class="headerlink" href="#kornia.contrib.FaceDetectorResult.bottom_left" title="Link to this definition">¶</a></dt>
<dd><p>The [x y] position of the top-left coordinate of the bounding box.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="kornia.contrib.FaceDetectorResult.bottom_right">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bottom_right</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></em><a class="headerlink" href="#kornia.contrib.FaceDetectorResult.bottom_right" title="Link to this definition">¶</a></dt>
<dd><p>The [x y] position of the bottom-right coordinate of the bounding box.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.FaceDetectorResult.get_keypoint">
<span class="sig-name descname"><span class="pre">get_keypoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keypoint</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.FaceDetectorResult.get_keypoint" title="Link to this definition">¶</a></dt>
<dd><p>Get the [x y] position of a given facial keypoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>keypoint</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.FaceKeypoint" title="kornia.contrib.face_detection.FaceKeypoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">FaceKeypoint</span></code></a></span>) – the keypoint type to return the position.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="kornia.contrib.FaceDetectorResult.height">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">height</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></em><a class="headerlink" href="#kornia.contrib.FaceDetectorResult.height" title="Link to this definition">¶</a></dt>
<dd><p>The bounding box height.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="kornia.contrib.FaceDetectorResult.score">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">score</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></em><a class="headerlink" href="#kornia.contrib.FaceDetectorResult.score" title="Link to this definition">¶</a></dt>
<dd><p>The detection score.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.FaceDetectorResult.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.FaceDetectorResult.to" title="Link to this definition">¶</a></dt>
<dd><p>Like <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.nn.Module.to()</span></code> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.FaceDetectorResult" title="kornia.contrib.face_detection.FaceDetectorResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">FaceDetectorResult</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="kornia.contrib.FaceDetectorResult.top_left">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">top_left</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></em><a class="headerlink" href="#kornia.contrib.FaceDetectorResult.top_left" title="Link to this definition">¶</a></dt>
<dd><p>The [x y] position of the top-left coordinate of the bounding box.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="kornia.contrib.FaceDetectorResult.top_right">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">top_right</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></em><a class="headerlink" href="#kornia.contrib.FaceDetectorResult.top_right" title="Link to this definition">¶</a></dt>
<dd><p>The [x y] position of the top-left coordinate of the bounding box.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="kornia.contrib.FaceDetectorResult.width">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">width</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></em><a class="headerlink" href="#kornia.contrib.FaceDetectorResult.width" title="Link to this definition">¶</a></dt>
<dd><p>The bounding box width.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="kornia.contrib.FaceDetectorResult.xmax">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xmax</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></em><a class="headerlink" href="#kornia.contrib.FaceDetectorResult.xmax" title="Link to this definition">¶</a></dt>
<dd><p>The bounding box bottom-right x-coordinate.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="kornia.contrib.FaceDetectorResult.xmin">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xmin</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></em><a class="headerlink" href="#kornia.contrib.FaceDetectorResult.xmin" title="Link to this definition">¶</a></dt>
<dd><p>The bounding box top-left x-coordinate.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="kornia.contrib.FaceDetectorResult.ymax">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ymax</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></em><a class="headerlink" href="#kornia.contrib.FaceDetectorResult.ymax" title="Link to this definition">¶</a></dt>
<dd><p>The bounding box bottom-right y-coordinate.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="kornia.contrib.FaceDetectorResult.ymin">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ymin</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></em><a class="headerlink" href="#kornia.contrib.FaceDetectorResult.ymin" title="Link to this definition">¶</a></dt>
<dd><p>The bounding box top-left y-coordinate.</p>
</dd></dl>

</dd></dl>

<section id="interactive-demo">
<h3>Interactive Demo<a class="headerlink" href="#interactive-demo" title="Link to this heading">¶</a></h3>
<gradio-app src="kornia/Face-Detection"></gradio-app><p>Visit the <a class="reference external" href="https://huggingface.co/spaces/kornia/Face-Detection">Kornia face detection demo on the Hugging Face Spaces</a>.</p>
</section>
</section>
<section id="object-detection">
<h2>Object Detection<a class="headerlink" href="#object-detection" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.object_detection.BoundingBoxDataFormat">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.object_detection.</span></span><span class="sig-name descname"><span class="pre">BoundingBoxDataFormat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.object_detection.BoundingBoxDataFormat" title="Link to this definition">¶</a></dt>
<dd><p>Enum class that maps bounding box data format.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.object_detection.BoundingBoxDataFormat.XYWH">
<span class="sig-name descname"><span class="pre">XYWH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#kornia.contrib.object_detection.BoundingBoxDataFormat.XYWH" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.object_detection.BoundingBoxDataFormat.XYXY">
<span class="sig-name descname"><span class="pre">XYXY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#kornia.contrib.object_detection.BoundingBoxDataFormat.XYXY" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.object_detection.BoundingBoxDataFormat.CXCYWH">
<span class="sig-name descname"><span class="pre">CXCYWH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#kornia.contrib.object_detection.BoundingBoxDataFormat.CXCYWH" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.object_detection.BoundingBoxDataFormat.CENTER_XYWH">
<span class="sig-name descname"><span class="pre">CENTER_XYWH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#kornia.contrib.object_detection.BoundingBoxDataFormat.CENTER_XYWH" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.object_detection.BoundingBox">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.object_detection.</span></span><span class="sig-name descname"><span class="pre">BoundingBox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.object_detection.BoundingBox" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.object_detection.ObjectDetectorResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.object_detection.</span></span><span class="sig-name descname"><span class="pre">ObjectDetectorResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.object_detection.ObjectDetectorResult" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.object_detection.ObjectDetector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.object_detection.</span></span><span class="sig-name descname"><span class="pre">ObjectDetector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.object_detection.ObjectDetector" title="Link to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.object_detection.ObjectDetector.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.object_detection.ObjectDetector.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Construct an Object Detector object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – an object detection model.</p></li>
<li><p><strong>pre_processor</strong> – a pre-processing module</p></li>
<li><p><strong>post_processor</strong> – a post-processing module.</p></li>
<li><p><strong>name</strong> – name of a model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.object_detection.ResizePreProcessor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.object_detection.</span></span><span class="sig-name descname"><span class="pre">ResizePreProcessor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.object_detection.ResizePreProcessor" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kornia.contrib.object_detection.results_from_detections">
<span class="sig-prename descclassname"><span class="pre">kornia.contrib.object_detection.</span></span><span class="sig-name descname"><span class="pre">results_from_detections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.object_detection.results_from_detections" title="Link to this definition">¶</a></dt>
<dd><p>Return detector results.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ObjectDetectorResult</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

<section id="real-time-detection-transformer-rt-detr">
<h3>Real-Time Detection Transformer (RT-DETR)<a class="headerlink" href="#real-time-detection-transformer-rt-detr" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRModelType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.rt_detr.</span></span><span class="sig-name descname"><span class="pre">RTDETRModelType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRModelType" title="Link to this definition">¶</a></dt>
<dd><p>Enum class that maps RT-DETR model type.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRModelType.resnet18d">
<span class="sig-name descname"><span class="pre">resnet18d</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRModelType.resnet18d" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRModelType.resnet34d">
<span class="sig-name descname"><span class="pre">resnet34d</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRModelType.resnet34d" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRModelType.resnet50d">
<span class="sig-name descname"><span class="pre">resnet50d</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRModelType.resnet50d" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRModelType.resnet101d">
<span class="sig-name descname"><span class="pre">resnet101d</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRModelType.resnet101d" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRModelType.hgnetv2_l">
<span class="sig-name descname"><span class="pre">hgnetv2_l</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRModelType.hgnetv2_l" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRModelType.hgnetv2_x">
<span class="sig-name descname"><span class="pre">hgnetv2_x</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRModelType.hgnetv2_x" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRModelType.resnet50d_m">
<span class="sig-name descname"><span class="pre">resnet50d_m</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRModelType.resnet50d_m" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.rt_detr.</span></span><span class="sig-name descname"><span class="pre">RTDETRConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">640</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neck_hidden_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neck_dim_feedforward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neck_expansion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_hidden_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_num_queries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_num_decoder_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRConfig" title="Link to this definition">¶</a></dt>
<dd><p>Configuration to construct RT-DETR model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_type</strong> (<span class="sphinx_autodoc_typehints-type">RTDETRModelType | str | int</span>) – <p>model variant. Available models are</p>
<ul>
<li><p>ResNetD-18: <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">'resnet18d'</span></code> or <a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRModelType.resnet18d" title="kornia.contrib.models.rt_detr.RTDETRModelType.resnet18d"><code class="xref py py-attr docutils literal notranslate"><span class="pre">RTDETRModelType.resnet18d</span></code></a></p></li>
<li><p>ResNetD-34: <code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">'resnet34d'</span></code> or <a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRModelType.resnet34d" title="kornia.contrib.models.rt_detr.RTDETRModelType.resnet34d"><code class="xref py py-attr docutils literal notranslate"><span class="pre">RTDETRModelType.resnet34d</span></code></a></p></li>
<li><p>ResNetD-50: <code class="docutils literal notranslate"><span class="pre">2</span></code>, <code class="docutils literal notranslate"><span class="pre">'resnet50d'</span></code> or <a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRModelType.resnet50d" title="kornia.contrib.models.rt_detr.RTDETRModelType.resnet50d"><code class="xref py py-attr docutils literal notranslate"><span class="pre">RTDETRModelType.resnet50d</span></code></a></p></li>
<li><p>ResNetD-101: <code class="docutils literal notranslate"><span class="pre">3</span></code>, <code class="docutils literal notranslate"><span class="pre">'resnet101d'</span></code> or <a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRModelType.resnet101d" title="kornia.contrib.models.rt_detr.RTDETRModelType.resnet101d"><code class="xref py py-attr docutils literal notranslate"><span class="pre">RTDETRModelType.resnet101d</span></code></a></p></li>
<li><p>HGNetV2-L: <code class="docutils literal notranslate"><span class="pre">4</span></code>, <code class="docutils literal notranslate"><span class="pre">'hgnetv2_l'</span></code> or <a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRModelType.hgnetv2_l" title="kornia.contrib.models.rt_detr.RTDETRModelType.hgnetv2_l"><code class="xref py py-attr docutils literal notranslate"><span class="pre">RTDETRModelType.hgnetv2_l</span></code></a></p></li>
<li><p>HGNetV2-X: <code class="docutils literal notranslate"><span class="pre">5</span></code>, <code class="docutils literal notranslate"><span class="pre">'hgnetv2_x'</span></code> or <a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRModelType.hgnetv2_x" title="kornia.contrib.models.rt_detr.RTDETRModelType.hgnetv2_x"><code class="xref py py-attr docutils literal notranslate"><span class="pre">RTDETRModelType.hgnetv2_x</span></code></a></p></li>
</ul>
</p></li>
<li><p><strong>num_classes</strong> (<span class="sphinx_autodoc_typehints-type">int</span>) – number of classes.</p></li>
<li><p><strong>checkpoint</strong> (<span class="sphinx_autodoc_typehints-type">Optional[str]</span>, <em>optional</em>) – URL or local path of model weights.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>neck_hidden_dim</strong> (<span class="sphinx_autodoc_typehints-type">Optional[int]</span>, <em>optional</em>) – hidden dim for neck.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>neck_dim_feedforward</strong> (<span class="sphinx_autodoc_typehints-type">Optional[int]</span>, <em>optional</em>) – feed-forward network dim for neck.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>neck_expansion</strong> (<span class="sphinx_autodoc_typehints-type">Optional[float]</span>, <em>optional</em>) – expansion ratio for neck.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>head_hidden_dim</strong> (<span class="sphinx_autodoc_typehints-type">int</span>, <em>optional</em>) – hidden dim for head.
Default:  <code class="code docutils literal notranslate"><span class="pre">256</span></code></p></li>
<li><p><strong>head_num_queries</strong> (<span class="sphinx_autodoc_typehints-type">int</span>, <em>optional</em>) – number of queries for Deformable DETR transformer decoder.
Default:  <code class="code docutils literal notranslate"><span class="pre">300</span></code></p></li>
<li><p><strong>head_num_decoder_layers</strong> (<span class="sphinx_autodoc_typehints-type">Optional[int]</span>, <em>optional</em>) – number of decoder layers for Deformable DETR transformer decoder.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRConfig.checkpoint">
<span class="sig-name descname"><span class="pre">checkpoint</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[str]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRConfig.checkpoint" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRConfig.confidence_threshold">
<span class="sig-name descname"><span class="pre">confidence_threshold</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.3</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRConfig.confidence_threshold" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRConfig.from_name">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRConfig.from_name" title="Link to this definition">¶</a></dt>
<dd><p>Load model without pretrained weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – ‘rtdetr_r18vd’, ‘rtdetr_r34vd’, ‘rtdetr_r50vd_m’, ‘rtdetr_r50vd’, ‘rtdetr_r101vd’.</p></li>
<li><p><strong>num_classes</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>, <em>optional</em>) – Number of classes to detect.
Default:  <code class="code docutils literal notranslate"><span class="pre">80</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRConfig" title="kornia.contrib.models.rt_detr.model.RTDETRConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">RTDETRConfig</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRConfig.head_hidden_dim">
<span class="sig-name descname"><span class="pre">head_hidden_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">256</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRConfig.head_hidden_dim" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRConfig.head_num_decoder_layers">
<span class="sig-name descname"><span class="pre">head_num_decoder_layers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[int]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRConfig.head_num_decoder_layers" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRConfig.head_num_queries">
<span class="sig-name descname"><span class="pre">head_num_queries</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">300</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRConfig.head_num_queries" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRConfig.input_size">
<span class="sig-name descname"><span class="pre">input_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">640</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRConfig.input_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRConfig.model_type">
<span class="sig-name descname"><span class="pre">model_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">RTDETRModelType</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">int</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRConfig.model_type" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRConfig.neck_dim_feedforward">
<span class="sig-name descname"><span class="pre">neck_dim_feedforward</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[int]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRConfig.neck_dim_feedforward" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRConfig.neck_expansion">
<span class="sig-name descname"><span class="pre">neck_expansion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[float]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRConfig.neck_expansion" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRConfig.neck_hidden_dim">
<span class="sig-name descname"><span class="pre">neck_hidden_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[int]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRConfig.neck_hidden_dim" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETRConfig.num_classes">
<span class="sig-name descname"><span class="pre">num_classes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETRConfig.num_classes" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.rt_detr.</span></span><span class="sig-name descname"><span class="pre">RTDETR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backbone</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETR" title="Link to this definition">¶</a></dt>
<dd><p>RT-DETR Object Detection model, as described in <a class="reference external" href="https://arxiv.org/abs/2304.08069">https://arxiv.org/abs/2304.08069</a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETR.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backbone</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETR.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Construct RT-DETR Object Detection model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>backbone</strong> (<span class="sphinx_autodoc_typehints-type">ResNetD | PPHGNetV2</span>) – backbone network for feature extraction.</p></li>
<li><p><strong>encoder</strong> (<span class="sphinx_autodoc_typehints-type">HybridEncoder</span>) – neck network for feature fusion.</p></li>
<li><p><strong>decoder</strong> (<span class="sphinx_autodoc_typehints-type">RTDETRHead</span>) – head network to decode features into detection results.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETR.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETR.forward" title="Link to this definition">¶</a></dt>
<dd><p>Detect objects in an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>images</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – images to be detected. Shape <span class="math notranslate nohighlight">\((N, C, H, W)\)</span>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>logits</strong> - Tensor of shape <span class="math notranslate nohighlight">\((N, Q, K)\)</span>, where <span class="math notranslate nohighlight">\(Q\)</span> is the number of queries,
<span class="math notranslate nohighlight">\(K\)</span> is the number of classes.</p></li>
<li><p><strong>boxes</strong> - Tensor of shape <span class="math notranslate nohighlight">\((N, Q, 4)\)</span>, where <span class="math notranslate nohighlight">\(Q\)</span> is the number of queries.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETR.from_config">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETR.from_config" title="Link to this definition">¶</a></dt>
<dd><p>Construct RT-DETR Object Detection model from a config object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRConfig" title="kornia.contrib.models.rt_detr.model.RTDETRConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">RTDETRConfig</span></code></a></span>) – configuration object for RT-DETR.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETR" title="kornia.contrib.models.rt_detr.model.RTDETR"><code class="xref py py-class docutils literal notranslate"><span class="pre">RTDETR</span></code></a></span></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For <code class="docutils literal notranslate"><span class="pre">config.neck_hidden_dim</span></code>, <code class="docutils literal notranslate"><span class="pre">config.neck_dim_feedforward</span></code>, <code class="docutils literal notranslate"><span class="pre">config.neck_expansion</span></code>, and
<code class="docutils literal notranslate"><span class="pre">config.head_num_decoder_layers</span></code>, if they are <code class="docutils literal notranslate"><span class="pre">None</span></code>, their values will be replaced with the
default values depending on the <code class="docutils literal notranslate"><span class="pre">config.model_type</span></code>. See the source code for the default values.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.RTDETR.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.rt_detr.RTDETR.load_checkpoint" title="Link to this definition">¶</a></dt>
<dd><p>Load checkpoint from a given url or file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checkpoint</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The url or filepath for the respective checkpoint</p></li>
<li><p><strong>device</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code></a>]</span>, <em>optional</em>) – The desired device to load the weights and move the model
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.DETRPostProcessor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.rt_detr.</span></span><span class="sig-name descname"><span class="pre">DETRPostProcessor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">confidence_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_top_queries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_filtering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_as_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.rt_detr.DETRPostProcessor" title="Link to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.rt_detr.DETRPostProcessor.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_sizes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.rt_detr.DETRPostProcessor.forward" title="Link to this definition">¶</a></dt>
<dd><p>Post-process outputs from DETR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logits</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – tensor with shape <span class="math notranslate nohighlight">\((N, Q, K)\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is the batch size, <span class="math notranslate nohighlight">\(Q\)</span> is the number of
queries, <span class="math notranslate nohighlight">\(K\)</span> is the number of classes.</p></li>
<li><p><strong>boxes</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – tensor with shape <span class="math notranslate nohighlight">\((N, Q, 4)\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is the batch size, <span class="math notranslate nohighlight">\(Q\)</span> is the number of
queries.</p></li>
<li><p><strong>original_sizes</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – tensor with shape <span class="math notranslate nohighlight">\((N, 2)\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is the batch size and each element
represents the image size of (img_height, img_width).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Processed detections. For each image, the detections have shape (D, 6), where D is the number of detections
in that image, 6 represent (class_id, confidence_score, x, y, w, h).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="image-segmentation">
<h2>Image Segmentation<a class="headerlink" href="#image-segmentation" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="kornia.contrib.connected_components">
<span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">connected_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.connected_components" title="Link to this definition">¶</a></dt>
<dd><p>Compute the Connected-component labelling (CCL) algorithm.</p>
<img alt="https://github.com/kornia/data/raw/main/cells_segmented.png" src="https://github.com/kornia/data/raw/main/cells_segmented.png" />
<p>The implementation is an adaptation of the following repository:</p>
<p><a class="reference external" href="https://gist.github.com/efirdc/5d8bd66859e574c683a504a4690ae8bc">https://gist.github.com/efirdc/5d8bd66859e574c683a504a4690ae8bc</a></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an experimental API subject to changes and optimization improvements.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See a working example <a class="reference external" href="https://kornia.github.io/tutorials/nbs/connected_components.html">here</a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – the binarized input image with shape <span class="math notranslate nohighlight">\((*, 1, H, W)\)</span>.
The image must be in floating point with range [0, 1].</p></li>
<li><p><strong>num_iterations</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>, <em>optional</em>) – the number of iterations to make the algorithm to converge.
Default:  <code class="code docutils literal notranslate"><span class="pre">100</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The labels image with the same shape of the input image.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_labels</span> <span class="o">=</span> <span class="n">connected_components</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">num_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<section id="segment-anything-sam">
<h3>Segment Anything (SAM)<a class="headerlink" href="#segment-anything-sam" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.SamModelType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.sam.</span></span><span class="sig-name descname"><span class="pre">SamModelType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.sam.SamModelType" title="Link to this definition">¶</a></dt>
<dd><p>Map the SAM model types.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.SamModelType.vit_h">
<span class="sig-name descname"><span class="pre">vit_h</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#kornia.contrib.models.sam.SamModelType.vit_h" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.SamModelType.vit_l">
<span class="sig-name descname"><span class="pre">vit_l</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#kornia.contrib.models.sam.SamModelType.vit_l" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.SamModelType.vit_b">
<span class="sig-name descname"><span class="pre">vit_b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#kornia.contrib.models.sam.SamModelType.vit_b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.SamModelType.mobile_sam">
<span class="sig-name descname"><span class="pre">mobile_sam</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#kornia.contrib.models.sam.SamModelType.mobile_sam" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.SamConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.sam.</span></span><span class="sig-name descname"><span class="pre">SamConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_embed_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_num_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_global_attn_indexes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.sam.SamConfig" title="Link to this definition">¶</a></dt>
<dd><p>Encapsulate the Config to build a SAM model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_type</strong> (<span class="sphinx_autodoc_typehints-type">Optional[str | int | SamModelType]</span>, <em>optional</em>) – <p>the available models are:
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p>
<ul>
<li><p>0, ‘vit_h’ or <code class="xref py py-func docutils literal notranslate"><span class="pre">kornia.contrib.sam.SamModelType.vit_h()</span></code></p></li>
<li><p>1, ‘vit_l’ or <code class="xref py py-func docutils literal notranslate"><span class="pre">kornia.contrib.sam.SamModelType.vit_l()</span></code></p></li>
<li><p>2, ‘vit_b’ or <code class="xref py py-func docutils literal notranslate"><span class="pre">kornia.contrib.sam.SamModelType.vit_b()</span></code></p></li>
<li><p>3, ‘mobile_sam’, or <code class="xref py py-func docutils literal notranslate"><span class="pre">kornia.contrib.sam.SamModelType.mobile_sam()</span></code></p></li>
</ul>
</p></li>
<li><p><strong>checkpoint</strong> (<span class="sphinx_autodoc_typehints-type">Optional[str]</span>, <em>optional</em>) – URL or a path for a file with the weights of the model
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>encoder_embed_dim</strong> (<span class="sphinx_autodoc_typehints-type">Optional[int]</span>, <em>optional</em>) – Patch embedding dimension.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>encoder_depth</strong> (<span class="sphinx_autodoc_typehints-type">Optional[int]</span>, <em>optional</em>) – Depth of ViT.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>encoder_num_heads</strong> (<span class="sphinx_autodoc_typehints-type">Optional[int]</span>, <em>optional</em>) – Number of attention heads in each ViT block.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>encoder_global_attn_indexes</strong> (<span class="sphinx_autodoc_typehints-type">Optional[tuple[int, …]]</span>, <em>optional</em>) – Encoder indexes for blocks using global attention.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.SamConfig.checkpoint">
<span class="sig-name descname"><span class="pre">checkpoint</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[str]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#kornia.contrib.models.sam.SamConfig.checkpoint" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.SamConfig.encoder_depth">
<span class="sig-name descname"><span class="pre">encoder_depth</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[int]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#kornia.contrib.models.sam.SamConfig.encoder_depth" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.SamConfig.encoder_embed_dim">
<span class="sig-name descname"><span class="pre">encoder_embed_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[int]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#kornia.contrib.models.sam.SamConfig.encoder_embed_dim" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.SamConfig.encoder_global_attn_indexes">
<span class="sig-name descname"><span class="pre">encoder_global_attn_indexes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[tuple[int,</span> <span class="pre">...]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#kornia.contrib.models.sam.SamConfig.encoder_global_attn_indexes" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.SamConfig.encoder_num_heads">
<span class="sig-name descname"><span class="pre">encoder_num_heads</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[int]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#kornia.contrib.models.sam.SamConfig.encoder_num_heads" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.SamConfig.model_type">
<span class="sig-name descname"><span class="pre">model_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[str</span> <span class="pre">|</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">SamModelType]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#kornia.contrib.models.sam.SamConfig.model_type" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.SamConfig.pretrained">
<span class="sig-name descname"><span class="pre">pretrained</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#kornia.contrib.models.sam.SamConfig.pretrained" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.Sam">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.models.sam.</span></span><span class="sig-name descname"><span class="pre">Sam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prompt_encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_decoder</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.sam.Sam" title="Link to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.Sam.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prompt_encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_decoder</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.sam.Sam.__init__" title="Link to this definition">¶</a></dt>
<dd><p>SAM predicts object masks from an image and input prompts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_encoder</strong> (<span class="sphinx_autodoc_typehints-type">ImageEncoderViT | TinyViT</span>) – The backbone used to encode the image into image embeddings that allow for efficient mask
prediction.</p></li>
<li><p><strong>prompt_encoder</strong> (<span class="sphinx_autodoc_typehints-type">PromptEncoder</span>) – Encodes various types of input prompts.</p></li>
<li><p><strong>mask_decoder</strong> (<span class="sphinx_autodoc_typehints-type">MaskDecoder</span>) – Predicts masks from the image embeddings and encoded prompts.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.Sam.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batched_prompts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multimask_output</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.sam.Sam.forward" title="Link to this definition">¶</a></dt>
<dd><p>Predicts masks end-to-end from provided images and prompts.</p>
<p>This method expects that the images have already been pre-processed, at least been normalized, resized and
padded to be compatible with the <cite>self.image_encoder</cite>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For each image <span class="math notranslate nohighlight">\((3, H, W)\)</span>, it is possible to input a batch (<span class="math notranslate nohighlight">\(K\)</span>) of <span class="math notranslate nohighlight">\(N\)</span> prompts,
the results are batched by the number of prompts batch. So given a prompt with <span class="math notranslate nohighlight">\(K=5\)</span>, and
<span class="math notranslate nohighlight">\(N=10\)</span>, the results will look like <span class="math notranslate nohighlight">\(5xCxHxW\)</span> where <span class="math notranslate nohighlight">\(C\)</span> is determined by
multimask_output. And within each of these masks <span class="math notranslate nohighlight">\((5xC)\)</span>, it should be possible to find
<span class="math notranslate nohighlight">\(N\)</span> instances if the model succeed.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>images</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – The image as a torch tensor in <span class="math notranslate nohighlight">\((B, 3, H, W)\)</span> format, already transformed for input to the
model.</p></li>
<li><p><strong>batched_prompts</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – <dl class="simple">
<dt>A list over the batch of images (list length should be <span class="math notranslate nohighlight">\(B\)</span>), each a dictionary with</dt><dd><p>the following keys. If it does not have the respective prompt, it should not be included
in this dictionary. The options are:</p>
</dd>
</dl>
<ul>
<li><dl class="simple">
<dt>”points”: tuple of (Tensor, Tensor) within the coordinate keypoints and their respective labels.</dt><dd><p>the tuple should look like (keypoints, labels), where:</p>
<ul>
<li><p>The keypoints (a tensor) are a batched point prompts for this image, with shape
<span class="math notranslate nohighlight">\((K, N, 2)\)</span>. Already transformed to the input frame of the model.</p></li>
<li><p>The labels (a tensor) are a batched labels for point prompts, with shape <span class="math notranslate nohighlight">\((K, N)\)</span>.
Where 1 indicates a foreground point and 0 indicates a background point.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”boxes”: (Tensor) Batched box inputs, with shape <span class="math notranslate nohighlight">\((K, 4)\)</span>. Already transformed to the input</dt><dd><p>frame of the model.</p>
</dd>
</dl>
</li>
<li><p>”mask_inputs”: (Tensor) Batched mask inputs to the model, in the form <span class="math notranslate nohighlight">\((K, 1, H, W)\)</span>.</p></li>
</ul>
</p></li>
<li><p><strong>multimask_output</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Whether the model should predict multiple disambiguating masks, or return a single mask.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference internal" href="#kornia.contrib.models.SegmentationResults" title="kornia.contrib.models.structures.SegmentationResults"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentationResults</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A list over input images, where each element is as SegmentationResults the following.</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>logits: Low resolution logits with shape <span class="math notranslate nohighlight">\((K, C, H, W)\)</span>. Can be passed as mask input to</dt><dd><p>subsequent iterations of prediction. Where <span class="math notranslate nohighlight">\(K\)</span> is the number of input prompts,
<span class="math notranslate nohighlight">\(C\)</span> is determined by multimask_output, and <span class="math notranslate nohighlight">\(H=W=256\)</span> are the model output size.</p>
</dd>
</dl>
</li>
<li><p>scores: The model’s predictions of mask quality (iou prediction), in shape BxC.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.Sam.from_config">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.sam.Sam.from_config" title="Link to this definition">¶</a></dt>
<dd><p>Build/load the SAM model based on it’s config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.sam.SamConfig" title="kornia.contrib.models.sam.model.SamConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamConfig</span></code></a></span>) – The SamConfig data structure. If the model_type is available, build from it, otherwise will use
the parameters set.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.models.sam.Sam" title="kornia.contrib.models.sam.model.Sam"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sam</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The respective SAM model</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">kornia.contrib.models.sam</span><span class="w"> </span><span class="kn">import</span> <span class="n">SamConfig</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sam_model</span> <span class="o">=</span> <span class="n">Sam</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">SamConfig</span><span class="p">(</span><span class="s1">&#39;vit_b&#39;</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.models.sam.Sam.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.models.sam.Sam.load_checkpoint" title="Link to this definition">¶</a></dt>
<dd><p>Load checkpoint from a given url or file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checkpoint</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The url or filepath for the respective checkpoint</p></li>
<li><p><strong>device</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code></a>]</span>, <em>optional</em>) – The desired device to load the weights and move the model
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="image-patches">
<h2>Image Patches<a class="headerlink" href="#image-patches" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="kornia.contrib.compute_padding">
<span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">compute_padding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.compute_padding" title="Link to this definition">¶</a></dt>
<dd><p>Compute required padding to ensure chaining of <a class="reference internal" href="#kornia.contrib.extract_tensor_patches" title="kornia.contrib.extract_tensor_patches"><code class="xref py py-func docutils literal notranslate"><span class="pre">extract_tensor_patches()</span></code></a> and
<a class="reference internal" href="#kornia.contrib.combine_tensor_patches" title="kornia.contrib.combine_tensor_patches"><code class="xref py py-func docutils literal notranslate"><span class="pre">combine_tensor_patches()</span></code></a> produces expected result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>) – the size of the original tensor.</p></li>
<li><p><strong>window_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>) – the size of the sliding window used while extracting patches.</p></li>
<li><p><strong>stride</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>, <em>optional</em>) – The stride of the sliding window. Optional: if not specified, window_size will be used.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(top, bottom, left, right)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The required padding as a tuple of four ints</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">padding</span> <span class="o">=</span> <span class="n">compute_padding</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">extract_tensor_patches</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combine_tensor_patches</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">original_size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">window_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">unpadding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
<span class="go">tensor([[[[ 0,  1,  2],</span>
<span class="go">          [ 3,  4,  5],</span>
<span class="go">          [ 6,  7,  8],</span>
<span class="go">          [ 9, 10, 11]]]])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will be implicitly used in <a class="reference internal" href="#kornia.contrib.extract_tensor_patches" title="kornia.contrib.extract_tensor_patches"><code class="xref py py-func docutils literal notranslate"><span class="pre">extract_tensor_patches()</span></code></a> and <a class="reference internal" href="#kornia.contrib.combine_tensor_patches" title="kornia.contrib.combine_tensor_patches"><code class="xref py py-func docutils literal notranslate"><span class="pre">combine_tensor_patches()</span></code></a> if
<cite>allow_auto_(un)padding</cite> is set to True.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kornia.contrib.extract_tensor_patches">
<span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">extract_tensor_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_auto_padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.extract_tensor_patches" title="Link to this definition">¶</a></dt>
<dd><p>Extract patches from tensors and stacks them.</p>
<p>See <a class="reference internal" href="#kornia.contrib.ExtractTensorPatches" title="kornia.contrib.ExtractTensorPatches"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExtractTensorPatches</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – tensor image where to extract the patches with shape <span class="math notranslate nohighlight">\((B, C, H, W)\)</span>.</p></li>
<li><p><strong>window_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>) – the size of the sliding window and the output patch size.</p></li>
<li><p><strong>stride</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>, <em>optional</em>) – stride of the sliding window.
Default:  <code class="code docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><strong>padding</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>, <em>optional</em>) – Zero-padding added to both side of the input.
Default:  <code class="code docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><strong>allow_auto_padding</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>, <em>optional</em>) – whether to allow automatic padding if the window and stride do not fit into the image.
Default:  <code class="code docutils literal notranslate"><span class="pre">False</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the tensor with the extracted patches with shape <span class="math notranslate nohighlight">\((B, N, C, H_{out}, W_{out})\)</span>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">9.</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patches</span> <span class="o">=</span> <span class="n">extract_tensor_patches</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span>
<span class="go">tensor([[[[0., 1., 2.],</span>
<span class="go">          [3., 4., 5.],</span>
<span class="go">          [6., 7., 8.]]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patches</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">tensor([[[[3., 4., 5.],</span>
<span class="go">          [6., 7., 8.]]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kornia.contrib.combine_tensor_patches">
<span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">combine_tensor_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patches</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_auto_unpadding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unpadding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.combine_tensor_patches" title="Link to this definition">¶</a></dt>
<dd><p>Restore input from patches.</p>
<p>See <a class="reference internal" href="#kornia.contrib.CombineTensorPatches" title="kornia.contrib.CombineTensorPatches"><code class="xref py py-class docutils literal notranslate"><span class="pre">CombineTensorPatches</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patches</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – patched tensor with shape <span class="math notranslate nohighlight">\((B, N, C, H_{out}, W_{out})\)</span>.</p></li>
<li><p><strong>original_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>) – the size of the original tensor and the output size.</p></li>
<li><p><strong>window_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>) – the size of the sliding window used while extracting patches.</p></li>
<li><p><strong>stride</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>) – stride of the sliding window.</p></li>
<li><p><strong>unpadding</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>, <em>optional</em>) – remove the padding added to both side of the input.
Default:  <code class="code docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><strong>allow_auto_unpadding</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>, <em>optional</em>) – whether to allow automatic unpadding of the input
if the window and stride do not fit into the original_size.
Default:  <code class="code docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>eps</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>, <em>optional</em>) – small value used to prevent division by zero.
Default:  <code class="code docutils literal notranslate"><span class="pre">1e-8</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The combined patches in an image tensor with shape <span class="math notranslate nohighlight">\((B, C, H, W)\)</span>.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">extract_tensor_patches</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">window_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combine_tensor_patches</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">original_size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">window_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">tensor([[[[ 0,  1,  2,  3],</span>
<span class="go">          [ 4,  5,  6,  7],</span>
<span class="go">          [ 8,  9, 10, 11],</span>
<span class="go">          [12, 13, 14, 15]]]])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is supposed to be used in conjunction with <a class="reference internal" href="#kornia.contrib.extract_tensor_patches" title="kornia.contrib.extract_tensor_patches"><code class="xref py py-func docutils literal notranslate"><span class="pre">extract_tensor_patches()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.ExtractTensorPatches">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">ExtractTensorPatches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_auto_padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.ExtractTensorPatches" title="Link to this definition">¶</a></dt>
<dd><p>Module that extract patches from tensors and stack them.</p>
<p>In the simplest case, the output value of the operator with input size
<span class="math notranslate nohighlight">\((B, C, H, W)\)</span> is <span class="math notranslate nohighlight">\((B, N, C, H_{out}, W_{out})\)</span>.</p>
<dl class="simple">
<dt>where</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(B\)</span> is the batch size.</p></li>
<li><p><span class="math notranslate nohighlight">\(N\)</span> denotes the total number of extracted patches stacked in</p></li>
<li><p><span class="math notranslate nohighlight">\(C\)</span> denotes the number of input channels.</p></li>
<li><p><span class="math notranslate nohighlight">\(H\)</span>, <span class="math notranslate nohighlight">\(W\)</span> the input height and width of the input in pixels.</p></li>
<li><p><span class="math notranslate nohighlight">\(H_{out}\)</span>, <span class="math notranslate nohighlight">\(W_{out}\)</span> denote to denote to the patch size
defined in the function signature.
left-right and top-bottom order.</p></li>
</ul>
</dd>
</dl>
<ul class="simple">
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">window_size</span></code> is the size of the sliding window and controls the
shape of the output tensor and defines the shape of the output patch.</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">stride</span></code> controls the stride to apply to the sliding window and
regulates the overlapping between the extracted patches.</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">padding</span></code> controls the amount of implicit zeros-paddings on both
sizes at each dimension.</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">allow_auto_padding</span></code> allows automatic calculation of the padding required
to fit the window and stride into the image.</p></li>
</ul>
<p>The parameters <code class="xref py py-attr docutils literal notranslate"><span class="pre">window_size</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">stride</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">padding</span></code> can
be either:</p>
<blockquote>
<div><ul class="simple">
<li><p>a single <code class="docutils literal notranslate"><span class="pre">int</span></code> – in which case the same value is used for the
height and width dimension.</p></li>
<li><p>a <code class="docutils literal notranslate"><span class="pre">tuple</span></code> of two ints – in which case, the first <cite>int</cite> is used for
the height dimension, and the second <cite>int</cite> for the width dimension.</p></li>
</ul>
</div></blockquote>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">padding</span></code> can also be a <code class="docutils literal notranslate"><span class="pre">tuple</span></code> of four ints – in which case, the
first two ints are for the height dimension while the last two ints are for
the width dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> – tensor image where to extract the patches with shape <span class="math notranslate nohighlight">\((B, C, H, W)\)</span>.</p></li>
<li><p><strong>window_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>) – the size of the sliding window and the output patch size.</p></li>
<li><p><strong>stride</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>, <em>optional</em>) – stride of the sliding window.
Default:  <code class="code docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><strong>padding</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>, <em>optional</em>) – Zero-padding added to both side of the input.
Default:  <code class="code docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><strong>allow_auto_adding</strong> – whether to allow automatic padding if the window and stride do not fit into the image.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><p>Input: <span class="math notranslate nohighlight">\((B, C, H, W)\)</span></p></li>
<li><p>Output: <span class="math notranslate nohighlight">\((B, N, C, H_{out}, W_{out})\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the tensor with the extracted patches.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">9.</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patches</span> <span class="o">=</span> <span class="n">extract_tensor_patches</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span>
<span class="go">tensor([[[[0., 1., 2.],</span>
<span class="go">          [3., 4., 5.],</span>
<span class="go">          [6., 7., 8.]]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patches</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">tensor([[[[3., 4., 5.],</span>
<span class="go">          [6., 7., 8.]]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.CombineTensorPatches">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">CombineTensorPatches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unpadding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_auto_unpadding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.CombineTensorPatches" title="Link to this definition">¶</a></dt>
<dd><p>Module that combines patches back into full tensors.</p>
<p>In the simplest case, the output value of the operator with input size
<span class="math notranslate nohighlight">\((B, N, C, H_{out}, W_{out})\)</span> is <span class="math notranslate nohighlight">\((B, C, H, W)\)</span>.</p>
<dl class="simple">
<dt>where</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(B\)</span> is the batch size.</p></li>
<li><p><span class="math notranslate nohighlight">\(N\)</span> denotes the total number of extracted patches stacked in</p></li>
<li><p><span class="math notranslate nohighlight">\(C\)</span> denotes the number of input channels.</p></li>
<li><p><span class="math notranslate nohighlight">\(H\)</span>, <span class="math notranslate nohighlight">\(W\)</span> the input height and width of the input in pixels.</p></li>
<li><p><span class="math notranslate nohighlight">\(H_{out}\)</span>, <span class="math notranslate nohighlight">\(W_{out}\)</span> denote to denote to the patch size
defined in the function signature.
left-right and top-bottom order.</p></li>
</ul>
</dd>
</dl>
<ul class="simple">
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">original_size</span></code> is the size of the original image prior to
extracting tensor patches and defines the shape of the output patch.</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">window_size</span></code> is the size of the sliding window used while
extracting tensor patches.</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">stride</span></code> controls the stride to apply to the sliding window and
regulates the overlapping between the extracted patches.</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">unpadding</span></code> is the amount of padding to be removed. If specified,
this value must be the same as padding used while extracting tensor patches.</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">allow_auto_unpadding</span></code> allows automatic calculation of the padding required
to fit the window and stride into the image. This must be used if the
<cite>allow_auto_padding</cite> flag was used for extracting the patches.</p></li>
</ul>
<p>The parameters <code class="xref py py-attr docutils literal notranslate"><span class="pre">original_size</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">window_size</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">stride</span></code>, and <code class="xref py py-attr docutils literal notranslate"><span class="pre">unpadding</span></code> can
be either:</p>
<blockquote>
<div><ul class="simple">
<li><p>a single <code class="docutils literal notranslate"><span class="pre">int</span></code> – in which case the same value is used for the
height and width dimension.</p></li>
<li><p>a <code class="docutils literal notranslate"><span class="pre">tuple</span></code> of two ints – in which case, the first <cite>int</cite> is used for
the height dimension, and the second <cite>int</cite> for the width dimension.</p></li>
</ul>
</div></blockquote>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">unpadding</span></code> can also be a <code class="docutils literal notranslate"><span class="pre">tuple</span></code> of four ints – in which case, the
first two ints are for the height dimension while the last two ints are for
the width dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patches</strong> – patched tensor with shape <span class="math notranslate nohighlight">\((B, N, C, H_{out}, W_{out})\)</span>.</p></li>
<li><p><strong>original_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – the size of the original tensor and the output size.</p></li>
<li><p><strong>window_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>) – the size of the sliding window used while extracting patches.</p></li>
<li><p><strong>stride</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>, <em>optional</em>) – stride of the sliding window.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>unpadding</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>, <em>optional</em>) – remove the padding added to both side of the input.
Default:  <code class="code docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><strong>allow_auto_unpadding</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>, <em>optional</em>) – whether to allow automatic unpadding of the input
if the window and stride do not fit into the original_size.
Default:  <code class="code docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>eps</strong> – small value used to prevent division by zero.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><p>Input: <span class="math notranslate nohighlight">\((B, N, C, H_{out}, W_{out})\)</span></p></li>
<li><p>Output: <span class="math notranslate nohighlight">\((B, C, H, W)\)</span></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">extract_tensor_patches</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">window_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combine_tensor_patches</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">original_size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">window_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">tensor([[[[ 0,  1,  2,  3],</span>
<span class="go">          [ 4,  5,  6,  7],</span>
<span class="go">          [ 8,  9, 10, 11],</span>
<span class="go">          [12, 13, 14, 15]]]])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is supposed to be used in conjunction with <a class="reference internal" href="#kornia.contrib.ExtractTensorPatches" title="kornia.contrib.ExtractTensorPatches"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExtractTensorPatches</span></code></a>.</p>
</div>
</dd></dl>

</section>
<section id="image-classification">
<h2>Image Classification<a class="headerlink" href="#image-classification" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.VisionTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">VisionTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">224</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_attn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.VisionTransformer" title="Link to this definition">¶</a></dt>
<dd><p>Vision transformer (ViT) module.</p>
<p>The module is expected to be used as operator for different vision tasks.</p>
<p>The method is inspired from existing implementations of the paper <span id="id3">[<a class="reference internal" href="community/bibliography.html#id2" title="Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Sylvain Gelly, Jakob Uszkoreit, and Neil Houlsby. An image is worth 16x16 words: transformers for image recognition at scale. ICLR, 2021.">DBK+21</a>]</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an experimental API subject to changes in favor of flexibility.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_size</strong> (<span class="sphinx_autodoc_typehints-type">int</span>, <em>optional</em>) – the size of the input image.
Default:  <code class="code docutils literal notranslate"><span class="pre">224</span></code></p></li>
<li><p><strong>patch_size</strong> (<span class="sphinx_autodoc_typehints-type">int</span>, <em>optional</em>) – the size of the patch to compute the embedding.
Default:  <code class="code docutils literal notranslate"><span class="pre">16</span></code></p></li>
<li><p><strong>in_channels</strong> (<span class="sphinx_autodoc_typehints-type">int</span>, <em>optional</em>) – the number of channels for the input.
Default:  <code class="code docutils literal notranslate"><span class="pre">3</span></code></p></li>
<li><p><strong>embed_dim</strong> (<span class="sphinx_autodoc_typehints-type">int</span>, <em>optional</em>) – the embedding dimension inside the transformer encoder.
Default:  <code class="code docutils literal notranslate"><span class="pre">768</span></code></p></li>
<li><p><strong>depth</strong> (<span class="sphinx_autodoc_typehints-type">int</span>, <em>optional</em>) – the depth of the transformer.
Default:  <code class="code docutils literal notranslate"><span class="pre">12</span></code></p></li>
<li><p><strong>num_heads</strong> (<span class="sphinx_autodoc_typehints-type">int</span>, <em>optional</em>) – the number of attention heads.
Default:  <code class="code docutils literal notranslate"><span class="pre">12</span></code></p></li>
<li><p><strong>dropout_rate</strong> (<span class="sphinx_autodoc_typehints-type">float</span>, <em>optional</em>) – dropout rate.
Default:  <code class="code docutils literal notranslate"><span class="pre">0.0</span></code></p></li>
<li><p><strong>dropout_attn</strong> (<span class="sphinx_autodoc_typehints-type">float</span>, <em>optional</em>) – attention dropout rate.
Default:  <code class="code docutils literal notranslate"><span class="pre">0.0</span></code></p></li>
<li><p><strong>backbone</strong> (<span class="sphinx_autodoc_typehints-type">Module | None</span>, <em>optional</em>) – an nn.Module to compute the image patches embeddings.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vit</span> <span class="o">=</span> <span class="n">VisionTransformer</span><span class="p">(</span><span class="n">image_size</span><span class="o">=</span><span class="mi">224</span><span class="p">,</span> <span class="n">patch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vit</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1, 197, 768])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.VisionTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.VisionTransformer.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.
:rtype: <span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.VisionTransformer.from_config">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.VisionTransformer.from_config" title="Link to this definition">¶</a></dt>
<dd><p>Build ViT model based on the given config string.</p>
<p>The format is <code class="docutils literal notranslate"><span class="pre">vit_{size}/{patch_size}</span></code>.
E.g. <code class="docutils literal notranslate"><span class="pre">vit_b/16</span></code> means ViT-Base, patch size 16x16. If <code class="docutils literal notranslate"><span class="pre">pretrained=True</span></code>, AugReg weights are loaded.
The weights are hosted on HuggingFace’s model hub: <a class="reference external" href="https://huggingface.co/kornia">https://huggingface.co/kornia</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The available weights are: <code class="docutils literal notranslate"><span class="pre">vit_l/16</span></code>, <code class="docutils literal notranslate"><span class="pre">vit_b/16</span></code>, <code class="docutils literal notranslate"><span class="pre">vit_s/16</span></code>, <code class="docutils literal notranslate"><span class="pre">vit_ti/16</span></code>,
<code class="docutils literal notranslate"><span class="pre">vit_b/32</span></code>, <code class="docutils literal notranslate"><span class="pre">vit_s/32</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variant</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – ViT model variant e.g. <code class="docutils literal notranslate"><span class="pre">vit_b/16</span></code>.</p></li>
<li><p><strong>pretrained</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>, <em>optional</em>) – whether to load pre-trained AugReg weights.
Default:  <code class="code docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>kwargs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>) – other keyword arguments that will be passed to <a class="reference internal" href="#kornia.contrib.VisionTransformer" title="kornia.contrib.vit.VisionTransformer"><code class="xref py py-func docutils literal notranslate"><span class="pre">kornia.contrib.vit.VisionTransformer()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#kornia.contrib.VisionTransformer" title="kornia.contrib.vit.VisionTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">VisionTransformer</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The respective ViT model</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">kornia.contrib</span><span class="w"> </span><span class="kn">import</span> <span class="n">VisionTransformer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vit_model</span> <span class="o">=</span> <span class="n">VisionTransformer</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="s2">&quot;vit_b/16&quot;</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.MobileViT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">MobileViT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xxs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.MobileViT" title="Link to this definition">¶</a></dt>
<dd><p>Module MobileViT. Default arguments is for MobileViT XXS.</p>
<p>Paper: <a class="reference external" href="https://arxiv.org/abs/2110.02178">https://arxiv.org/abs/2110.02178</a>
Based on: <a class="reference external" href="https://github.com/chinhsuanwu/mobilevit-pytorch">https://github.com/chinhsuanwu/mobilevit-pytorch</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>, <em>optional</em>) – ‘xxs’, ‘xs’ or ‘s’, defaults to ‘xxs’.
Default:  <code class="code docutils literal notranslate"><span class="pre">&quot;xxs&quot;</span></code></p></li>
<li><p><strong>in_channels</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>, <em>optional</em>) – the number of channels for the input image.
Default:  <code class="code docutils literal notranslate"><span class="pre">3</span></code></p></li>
<li><p><strong>patch_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>, <em>optional</em>) – image_size must be divisible by patch_size.
Default:  <code class="code docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2)</span></code></p></li>
<li><p><strong>dropout</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>, <em>optional</em>) – dropout ratio in Transformer.
Default:  <code class="code docutils literal notranslate"><span class="pre">0.0</span></code></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mvit</span> <span class="o">=</span> <span class="n">MobileViT</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;xxs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mvit</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1, 320, 8, 8])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.TinyViT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">TinyViT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">224</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_chans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(96,</span> <span class="pre">192,</span> <span class="pre">384,</span> <span class="pre">768)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">2,</span> <span class="pre">6,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">6,</span> <span class="pre">12,</span> <span class="pre">24)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">7,</span> <span class="pre">14,</span> <span class="pre">7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_path_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_checkpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mbconv_expand_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_conv_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nn.GELU</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mobile_sam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.TinyViT" title="Link to this definition">¶</a></dt>
<dd><p>TinyViT model, as described in <a class="reference external" href="https://arxiv.org/abs/2207.10666">https://arxiv.org/abs/2207.10666</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>, <em>optional</em>) – Size of input image.
Default:  <code class="code docutils literal notranslate"><span class="pre">224</span></code></p></li>
<li><p><strong>in_chans</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>, <em>optional</em>) – Number of input image’s channels.
Default:  <code class="code docutils literal notranslate"><span class="pre">3</span></code></p></li>
<li><p><strong>num_classes</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>, <em>optional</em>) – Number of output classes.
Default:  <code class="code docutils literal notranslate"><span class="pre">1000</span></code></p></li>
<li><p><strong>embed_dims</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>, <em>optional</em>) – List of embedding dimensions.
Default:  <code class="code docutils literal notranslate"><span class="pre">(96,</span> <span class="pre">192,</span> <span class="pre">384,</span> <span class="pre">768)</span></code></p></li>
<li><p><strong>depths</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>, <em>optional</em>) – List of block count for each downsampling stage
Default:  <code class="code docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2,</span> <span class="pre">6,</span> <span class="pre">2)</span></code></p></li>
<li><p><strong>num_heads</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>, <em>optional</em>) – List of attention heads used in self-attention for each downsampling stage.
Default:  <code class="code docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">6,</span> <span class="pre">12,</span> <span class="pre">24)</span></code></p></li>
<li><p><strong>window_sizes</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>, <em>optional</em>) – List of self-attention’s window size for each downsampling stage.
Default:  <code class="code docutils literal notranslate"><span class="pre">(7,</span> <span class="pre">7,</span> <span class="pre">14,</span> <span class="pre">7)</span></code></p></li>
<li><p><strong>mlp_ratio</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>, <em>optional</em>) – Ratio of MLP dimension to embedding dimension in self-attention.
Default:  <code class="code docutils literal notranslate"><span class="pre">4.0</span></code></p></li>
<li><p><strong>drop_rate</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>, <em>optional</em>) – Dropout rate.
Default:  <code class="code docutils literal notranslate"><span class="pre">0.0</span></code></p></li>
<li><p><strong>drop_path_rate</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>, <em>optional</em>) – Stochastic depth rate.
Default:  <code class="code docutils literal notranslate"><span class="pre">0.0</span></code></p></li>
<li><p><strong>use_checkpoint</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>, <em>optional</em>) – Whether to use activation checkpointing to trade compute for memory.
Default:  <code class="code docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>mbconv_expand_ratio</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>, <em>optional</em>) – Expansion ratio used in MBConv block.
Default:  <code class="code docutils literal notranslate"><span class="pre">4.0</span></code></p></li>
<li><p><strong>local_conv_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>, <em>optional</em>) – Kernel size of convolution used in TinyViTBlock
Default:  <code class="code docutils literal notranslate"><span class="pre">3</span></code></p></li>
<li><p><strong>activation</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a>]</span>, <em>optional</em>) – activation function.
Default:  <code class="code docutils literal notranslate"><span class="pre">nn.GELU</span></code></p></li>
<li><p><strong>mobile_same</strong> – Whether to use modifications for MobileSAM.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.TinyViT.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.TinyViT.forward" title="Link to this definition">¶</a></dt>
<dd><p>Classify images if <code class="docutils literal notranslate"><span class="pre">mobile_sam=False</span></code>, produce feature maps if <code class="docutils literal notranslate"><span class="pre">mobile_sam=True</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.TinyViT.from_config">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.TinyViT.from_config" title="Link to this definition">¶</a></dt>
<dd><p>Create a TinyViT model from pre-defined variants.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variant</strong> (<span class="sphinx_autodoc_typehints-type">str</span>) – TinyViT variant. Possible values: <code class="docutils literal notranslate"><span class="pre">'5m'</span></code>, <code class="docutils literal notranslate"><span class="pre">'11m'</span></code>, <code class="docutils literal notranslate"><span class="pre">'21m'</span></code>.</p></li>
<li><p><strong>pretrained</strong> (<span class="sphinx_autodoc_typehints-type">bool | str</span>, <em>optional</em>) – whether to use pre-trained weights. Possible values: <code class="docutils literal notranslate"><span class="pre">False</span></code>, <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">'in22k'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'in1k'</span></code>. For TinyViT-21M (<code class="docutils literal notranslate"><span class="pre">variant='21m'</span></code>), <code class="docutils literal notranslate"><span class="pre">'in1k_384'</span></code>, <code class="docutils literal notranslate"><span class="pre">'in1k_512'</span></code> are also available.
Default:  <code class="code docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>**kwargs</strong> (<span class="sphinx_autodoc_typehints-type">Any</span>) – other keyword arguments that will be passed to <a class="reference internal" href="#kornia.contrib.TinyViT" title="kornia.contrib.TinyViT"><code class="xref py py-class docutils literal notranslate"><span class="pre">TinyViT</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type">TinyViT</span></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When <code class="docutils literal notranslate"><span class="pre">img_size</span></code> is different from the pre-trained size, bicubic interpolation will be performed on
attention biases. When using <code class="docutils literal notranslate"><span class="pre">pretrained=True</span></code>, ImageNet-1k checkpoint (<code class="docutils literal notranslate"><span class="pre">'in1k'</span></code>) is used.
For feature extraction or fine-tuning, ImageNet-22k checkpoint (<code class="docutils literal notranslate"><span class="pre">'in22k'</span></code>) is preferred.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.ClassificationHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">ClassificationHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embed_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.ClassificationHead" title="Link to this definition">¶</a></dt>
<dd><p>Module to be used as a classification head.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>embed_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>, <em>optional</em>) – the logits tensor coming from the networks.
Default:  <code class="code docutils literal notranslate"><span class="pre">768</span></code></p></li>
<li><p><strong>num_classes</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>, <em>optional</em>) – an integer representing the numbers of classes to classify.
Default:  <code class="code docutils literal notranslate"><span class="pre">10</span></code></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">head</span> <span class="o">=</span> <span class="n">ClassificationHead</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">head</span><span class="p">(</span><span class="n">feat</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1, 10])</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="image-stitching">
<h2>Image Stitching<a class="headerlink" href="#image-stitching" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.ImageStitcher">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">ImageStitcher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matcher</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ransac'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blending_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'naive'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.ImageStitcher" title="Link to this definition">¶</a></dt>
<dd><p>Stitch two images with overlapping fields of view.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matcher</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></span>) – image feature matching module.</p></li>
<li><p><strong>estimator</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>, <em>optional</em>) – method to compute homography, either “vanilla” or “ransac”.
“ransac” is slower with a better accuracy.
Default:  <code class="code docutils literal notranslate"><span class="pre">&quot;ransac&quot;</span></code></p></li>
<li><p><strong>blending_method</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>, <em>optional</em>) – method to blend two images together.
Only “naive” is currently supported.
Default:  <code class="code docutils literal notranslate"><span class="pre">&quot;naive&quot;</span></code></p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Current implementation requires strict image ordering from left to right.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">IS</span> <span class="o">=</span> <span class="n">ImageStitcher</span><span class="p">(</span><span class="n">KF</span><span class="o">.</span><span class="n">LoFTR</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="s1">&#39;outdoor&#39;</span><span class="p">),</span> <span class="n">estimator</span><span class="o">=</span><span class="s1">&#39;ransac&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="c1"># Compute the stitched result with less GPU memory cost.</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">inference_mode</span><span class="p">():</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">IS</span><span class="p">(</span><span class="n">img_left</span><span class="p">,</span> <span class="n">img_right</span><span class="p">)</span>
<span class="c1"># Show the result</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">tensor_to_image</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="lambda">
<h2>Lambda<a class="headerlink" href="#lambda" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.Lambda">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">Lambda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.Lambda" title="Link to this definition">¶</a></dt>
<dd><p>Applies user-defined lambda as a transform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/constants.html#Ellipsis" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code></a>, <a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>) – Callable function.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The output of the user-defined lambda.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">kornia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Lambda</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">kornia</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb_to_grayscale</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1, 1, 5, 5])</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="distance-transform">
<h2>Distance Transform<a class="headerlink" href="#distance-transform" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="kornia.contrib.distance_transform">
<span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">distance_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.35</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.distance_transform" title="Link to this definition">¶</a></dt>
<dd><p>Approximates the Manhattan distance transform of images using cascaded convolution operations.</p>
<p>The value at each pixel in the output represents the distance to the nearest non-zero pixel in the image image.
It uses the method described in <span id="id4">[<a class="reference internal" href="community/bibliography.html#id28" title="Duc Duy Pham, Gurbandurdy Dovletov, and Josef Pauli. A differentiable convolutional distance transform layer for improved image segmentation. Pattern Recognition, 12544:432 - 444, 2020.">PDP20</a>]</span>.
The transformation is applied independently across the channel dimension of the images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – Image with shape <span class="math notranslate nohighlight">\((B,C,H,W)\)</span>.</p></li>
<li><p><strong>kernel_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>, <em>optional</em>) – size of the convolution kernel.
Default:  <code class="code docutils literal notranslate"><span class="pre">3</span></code></p></li>
<li><p><strong>h</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>, <em>optional</em>) – value that influence the approximation of the min function.
Default:  <code class="code docutils literal notranslate"><span class="pre">0.35</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor with shape <span class="math notranslate nohighlight">\((B,C,H,W)\)</span>.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor</span><span class="p">[:,:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dt</span> <span class="o">=</span> <span class="n">kornia</span><span class="o">.</span><span class="n">contrib</span><span class="o">.</span><span class="n">distance_transform</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kornia.contrib.diamond_square">
<span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">diamond_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roughness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.rand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.diamond_square" title="Link to this definition">¶</a></dt>
<dd><p>Generate Plasma Fractal Images using the diamond square algorithm.</p>
<p>See: <a class="reference external" href="https://en.wikipedia.org/wiki/Diamond-square_algorithm">https://en.wikipedia.org/wiki/Diamond-square_algorithm</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – a tuple of integers with the BxCxHxW of the image to be generated.</p></li>
<li><p><strong>roughness</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>, <em>optional</em>) – the scale value to apply at each recursion step.
Default:  <code class="code docutils literal notranslate"><span class="pre">0.5</span></code></p></li>
<li><p><strong>random_scale</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>, <em>optional</em>) – the initial value of the scale for recursion.
Default:  <code class="code docutils literal notranslate"><span class="pre">1.0</span></code></p></li>
<li><p><strong>random_fn</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/constants.html#Ellipsis" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code></a>, <a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>, <em>optional</em>) – the callable function to use to sample a random tensor.
Default:  <code class="code docutils literal notranslate"><span class="pre">torch.rand</span></code></p></li>
<li><p><strong>normalize_range</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]]</span>, <em>optional</em>) – whether to normalize using min-max the output map. In case of a
range is specified, min-max norm is applied between the provided range.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>device</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code></a>]</span>, <em>optional</em>) – the torch device to place the output map.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>dtype</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="http://pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code></a>]</span>, <em>optional</em>) – the torch dtype to place the output map.
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tensor with shape <span class="math notranslate nohighlight">\((B,C,H,W)\)</span> containing the fractal image.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.DistanceTransform">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">DistanceTransform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.35</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.DistanceTransform" title="Link to this definition">¶</a></dt>
<dd><p>Module that approximates the Manhattan (city block) distance transform of images using convolutions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>, <em>optional</em>) – size of the convolution kernel.
Default:  <code class="code docutils literal notranslate"><span class="pre">3</span></code></p></li>
<li><p><strong>h</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>, <em>optional</em>) – value that influence the approximation of the min function.
Default:  <code class="code docutils literal notranslate"><span class="pre">0.35</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="kmeans">
<h2>KMeans<a class="headerlink" href="#kmeans" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kornia.contrib.KMeans">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kornia.contrib.</span></span><span class="sig-name descname"><span class="pre">KMeans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_clusters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_centers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10e-4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.KMeans" title="Link to this definition">¶</a></dt>
<dd><p>Implements the kmeans clustering algorithm with euclidean distance as similarity measure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_clusters</strong> (<span class="sphinx_autodoc_typehints-type">int</span>) – number of clusters the data has to be assigned to</p></li>
<li><p><strong>cluster_centers</strong> (<span class="sphinx_autodoc_typehints-type">Tensor | None</span>) – tensor of starting cluster centres can be passed instead of num_clusters</p></li>
<li><p><strong>tolerance</strong> (<span class="sphinx_autodoc_typehints-type">float</span>, <em>optional</em>) – float value. the algorithm terminates if the shift in centers is less than tolerance
Default:  <code class="code docutils literal notranslate"><span class="pre">10e-4</span></code></p></li>
<li><p><strong>max_iterations</strong> (<span class="sphinx_autodoc_typehints-type">int</span>, <em>optional</em>) – number of iterations to run the algorithm for
Default:  <code class="code docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><strong>seed</strong> (<span class="sphinx_autodoc_typehints-type">int | None</span>, <em>optional</em>) – number to set torch manual seed for reproducibility
Default:  <code class="code docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">kornia</span><span class="o">.</span><span class="n">contrib</span><span class="o">.</span><span class="n">KMeans</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">10e-4</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.KMeans.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.KMeans.fit" title="Link to this definition">¶</a></dt>
<dd><p>Fit iterative KMeans clustering till a threshold for shift in cluster centers or a maximum no of iterations
have reached.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – 2D input tensor to be clustered</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kornia.contrib.KMeans.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kornia.contrib.KMeans.predict" title="Link to this definition">¶</a></dt>
<dd><p>Find the cluster center closest to each point in x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – 2D tensor</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="http://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>1D tensor containing cluster id assigned to each data point in x</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="core.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">kornia.core</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="color.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">kornia.color</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Kornia developers
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">kornia.contrib</a><ul>
<li><a class="reference internal" href="#models">Models</a><ul>
<li><a class="reference internal" href="#base">Base</a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.base.ModelBase"><code class="docutils literal notranslate"><span class="pre">ModelBase</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.base.ModelBase.compile"><code class="docutils literal notranslate"><span class="pre">ModelBase.compile()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.base.ModelBase.from_config"><code class="docutils literal notranslate"><span class="pre">ModelBase.from_config()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.base.ModelBase.load_checkpoint"><code class="docutils literal notranslate"><span class="pre">ModelBase.load_checkpoint()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#efficientvit">EfficientViT</a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.EfficientViT"><code class="docutils literal notranslate"><span class="pre">EfficientViT</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.EfficientViT.__init__"><code class="docutils literal notranslate"><span class="pre">EfficientViT.__init__()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.EfficientViT.forward"><code class="docutils literal notranslate"><span class="pre">EfficientViT.forward()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.EfficientViT.from_config"><code class="docutils literal notranslate"><span class="pre">EfficientViT.from_config()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.EfficientViT.load_checkpoint"><code class="docutils literal notranslate"><span class="pre">EfficientViT.load_checkpoint()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.EfficientViTConfig"><code class="docutils literal notranslate"><span class="pre">EfficientViTConfig</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.EfficientViTConfig.checkpoint"><code class="docutils literal notranslate"><span class="pre">EfficientViTConfig.checkpoint</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.EfficientViTConfig.from_pretrained"><code class="docutils literal notranslate"><span class="pre">EfficientViTConfig.from_pretrained()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#backbones">Backbones</a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTBackbone"><code class="docutils literal notranslate"><span class="pre">EfficientViTBackbone</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTBackbone.build_local_block"><code class="docutils literal notranslate"><span class="pre">EfficientViTBackbone.build_local_block()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTBackbone.forward"><code class="docutils literal notranslate"><span class="pre">EfficientViTBackbone.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_b0"><code class="docutils literal notranslate"><span class="pre">efficientvit_backbone_b0()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_b1"><code class="docutils literal notranslate"><span class="pre">efficientvit_backbone_b1()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_b2"><code class="docutils literal notranslate"><span class="pre">efficientvit_backbone_b2()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_b3"><code class="docutils literal notranslate"><span class="pre">efficientvit_backbone_b3()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTLargeBackbone"><code class="docutils literal notranslate"><span class="pre">EfficientViTLargeBackbone</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTLargeBackbone.build_local_block"><code class="docutils literal notranslate"><span class="pre">EfficientViTLargeBackbone.build_local_block()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.EfficientViTLargeBackbone.forward"><code class="docutils literal notranslate"><span class="pre">EfficientViTLargeBackbone.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_l0"><code class="docutils literal notranslate"><span class="pre">efficientvit_backbone_l0()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_l1"><code class="docutils literal notranslate"><span class="pre">efficientvit_backbone_l1()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_l2"><code class="docutils literal notranslate"><span class="pre">efficientvit_backbone_l2()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.efficient_vit.backbone.efficientvit_backbone_l3"><code class="docutils literal notranslate"><span class="pre">efficientvit_backbone_l3()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#structures">Structures</a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.SegmentationResults"><code class="docutils literal notranslate"><span class="pre">SegmentationResults</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.SegmentationResults.binary_masks"><code class="docutils literal notranslate"><span class="pre">SegmentationResults.binary_masks</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.SegmentationResults.logits"><code class="docutils literal notranslate"><span class="pre">SegmentationResults.logits</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.SegmentationResults.mask_threshold"><code class="docutils literal notranslate"><span class="pre">SegmentationResults.mask_threshold</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.SegmentationResults.original_res_logits"><code class="docutils literal notranslate"><span class="pre">SegmentationResults.original_res_logits()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.SegmentationResults.scores"><code class="docutils literal notranslate"><span class="pre">SegmentationResults.scores</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.SegmentationResults.squeeze"><code class="docutils literal notranslate"><span class="pre">SegmentationResults.squeeze()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kornia.contrib.models.Prompts"><code class="docutils literal notranslate"><span class="pre">Prompts</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.Prompts.boxes"><code class="docutils literal notranslate"><span class="pre">Prompts.boxes</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.Prompts.keypoints"><code class="docutils literal notranslate"><span class="pre">Prompts.keypoints</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.Prompts.keypoints_labels"><code class="docutils literal notranslate"><span class="pre">Prompts.keypoints_labels</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.Prompts.masks"><code class="docutils literal notranslate"><span class="pre">Prompts.masks</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.Prompts.points"><code class="docutils literal notranslate"><span class="pre">Prompts.points</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#visualprompter">VisualPrompter</a><ul>
<li><a class="reference internal" href="#kornia.contrib.visual_prompter.VisualPrompter"><code class="docutils literal notranslate"><span class="pre">VisualPrompter</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.visual_prompter.VisualPrompter.compile"><code class="docutils literal notranslate"><span class="pre">VisualPrompter.compile()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.visual_prompter.VisualPrompter.predict"><code class="docutils literal notranslate"><span class="pre">VisualPrompter.predict()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.visual_prompter.VisualPrompter.preprocess_image"><code class="docutils literal notranslate"><span class="pre">VisualPrompter.preprocess_image()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.visual_prompter.VisualPrompter.preprocess_prompts"><code class="docutils literal notranslate"><span class="pre">VisualPrompter.preprocess_prompts()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.visual_prompter.VisualPrompter.set_image"><code class="docutils literal notranslate"><span class="pre">VisualPrompter.set_image()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#edge-detection">Edge Detection</a><ul>
<li><a class="reference internal" href="#kornia.contrib.EdgeDetector"><code class="docutils literal notranslate"><span class="pre">EdgeDetector</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#face-detection">Face Detection</a><ul>
<li><a class="reference internal" href="#kornia.contrib.FaceDetector"><code class="docutils literal notranslate"><span class="pre">FaceDetector</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.FaceKeypoint"><code class="docutils literal notranslate"><span class="pre">FaceKeypoint</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.FaceKeypoint.EYE_LEFT"><code class="docutils literal notranslate"><span class="pre">FaceKeypoint.EYE_LEFT</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.FaceKeypoint.EYE_RIGHT"><code class="docutils literal notranslate"><span class="pre">FaceKeypoint.EYE_RIGHT</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.FaceKeypoint.MOUTH_LEFT"><code class="docutils literal notranslate"><span class="pre">FaceKeypoint.MOUTH_LEFT</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.FaceKeypoint.MOUTH_RIGHT"><code class="docutils literal notranslate"><span class="pre">FaceKeypoint.MOUTH_RIGHT</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.FaceKeypoint.NOSE"><code class="docutils literal notranslate"><span class="pre">FaceKeypoint.NOSE</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kornia.contrib.FaceDetectorResult"><code class="docutils literal notranslate"><span class="pre">FaceDetectorResult</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.FaceDetectorResult.bottom_left"><code class="docutils literal notranslate"><span class="pre">FaceDetectorResult.bottom_left</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.FaceDetectorResult.bottom_right"><code class="docutils literal notranslate"><span class="pre">FaceDetectorResult.bottom_right</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.FaceDetectorResult.get_keypoint"><code class="docutils literal notranslate"><span class="pre">FaceDetectorResult.get_keypoint()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.FaceDetectorResult.height"><code class="docutils literal notranslate"><span class="pre">FaceDetectorResult.height</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.FaceDetectorResult.score"><code class="docutils literal notranslate"><span class="pre">FaceDetectorResult.score</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.FaceDetectorResult.to"><code class="docutils literal notranslate"><span class="pre">FaceDetectorResult.to()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.FaceDetectorResult.top_left"><code class="docutils literal notranslate"><span class="pre">FaceDetectorResult.top_left</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.FaceDetectorResult.top_right"><code class="docutils literal notranslate"><span class="pre">FaceDetectorResult.top_right</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.FaceDetectorResult.width"><code class="docutils literal notranslate"><span class="pre">FaceDetectorResult.width</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.FaceDetectorResult.xmax"><code class="docutils literal notranslate"><span class="pre">FaceDetectorResult.xmax</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.FaceDetectorResult.xmin"><code class="docutils literal notranslate"><span class="pre">FaceDetectorResult.xmin</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.FaceDetectorResult.ymax"><code class="docutils literal notranslate"><span class="pre">FaceDetectorResult.ymax</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.FaceDetectorResult.ymin"><code class="docutils literal notranslate"><span class="pre">FaceDetectorResult.ymin</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#interactive-demo">Interactive Demo</a></li>
</ul>
</li>
<li><a class="reference internal" href="#object-detection">Object Detection</a><ul>
<li><a class="reference internal" href="#kornia.contrib.object_detection.BoundingBoxDataFormat"><code class="docutils literal notranslate"><span class="pre">BoundingBoxDataFormat</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.object_detection.BoundingBoxDataFormat.XYWH"><code class="docutils literal notranslate"><span class="pre">BoundingBoxDataFormat.XYWH</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.object_detection.BoundingBoxDataFormat.XYXY"><code class="docutils literal notranslate"><span class="pre">BoundingBoxDataFormat.XYXY</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.object_detection.BoundingBoxDataFormat.CXCYWH"><code class="docutils literal notranslate"><span class="pre">BoundingBoxDataFormat.CXCYWH</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.object_detection.BoundingBoxDataFormat.CENTER_XYWH"><code class="docutils literal notranslate"><span class="pre">BoundingBoxDataFormat.CENTER_XYWH</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kornia.contrib.object_detection.BoundingBox"><code class="docutils literal notranslate"><span class="pre">BoundingBox</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.object_detection.ObjectDetectorResult"><code class="docutils literal notranslate"><span class="pre">ObjectDetectorResult</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.object_detection.ObjectDetector"><code class="docutils literal notranslate"><span class="pre">ObjectDetector</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.object_detection.ObjectDetector.__init__"><code class="docutils literal notranslate"><span class="pre">ObjectDetector.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kornia.contrib.object_detection.ResizePreProcessor"><code class="docutils literal notranslate"><span class="pre">ResizePreProcessor</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.object_detection.results_from_detections"><code class="docutils literal notranslate"><span class="pre">results_from_detections()</span></code></a></li>
<li><a class="reference internal" href="#real-time-detection-transformer-rt-detr">Real-Time Detection Transformer (RT-DETR)</a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRModelType"><code class="docutils literal notranslate"><span class="pre">RTDETRModelType</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRModelType.resnet18d"><code class="docutils literal notranslate"><span class="pre">RTDETRModelType.resnet18d</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRModelType.resnet34d"><code class="docutils literal notranslate"><span class="pre">RTDETRModelType.resnet34d</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRModelType.resnet50d"><code class="docutils literal notranslate"><span class="pre">RTDETRModelType.resnet50d</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRModelType.resnet101d"><code class="docutils literal notranslate"><span class="pre">RTDETRModelType.resnet101d</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRModelType.hgnetv2_l"><code class="docutils literal notranslate"><span class="pre">RTDETRModelType.hgnetv2_l</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRModelType.hgnetv2_x"><code class="docutils literal notranslate"><span class="pre">RTDETRModelType.hgnetv2_x</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRModelType.resnet50d_m"><code class="docutils literal notranslate"><span class="pre">RTDETRModelType.resnet50d_m</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRConfig"><code class="docutils literal notranslate"><span class="pre">RTDETRConfig</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRConfig.checkpoint"><code class="docutils literal notranslate"><span class="pre">RTDETRConfig.checkpoint</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRConfig.confidence_threshold"><code class="docutils literal notranslate"><span class="pre">RTDETRConfig.confidence_threshold</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRConfig.from_name"><code class="docutils literal notranslate"><span class="pre">RTDETRConfig.from_name()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRConfig.head_hidden_dim"><code class="docutils literal notranslate"><span class="pre">RTDETRConfig.head_hidden_dim</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRConfig.head_num_decoder_layers"><code class="docutils literal notranslate"><span class="pre">RTDETRConfig.head_num_decoder_layers</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRConfig.head_num_queries"><code class="docutils literal notranslate"><span class="pre">RTDETRConfig.head_num_queries</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRConfig.input_size"><code class="docutils literal notranslate"><span class="pre">RTDETRConfig.input_size</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRConfig.model_type"><code class="docutils literal notranslate"><span class="pre">RTDETRConfig.model_type</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRConfig.neck_dim_feedforward"><code class="docutils literal notranslate"><span class="pre">RTDETRConfig.neck_dim_feedforward</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRConfig.neck_expansion"><code class="docutils literal notranslate"><span class="pre">RTDETRConfig.neck_expansion</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRConfig.neck_hidden_dim"><code class="docutils literal notranslate"><span class="pre">RTDETRConfig.neck_hidden_dim</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETRConfig.num_classes"><code class="docutils literal notranslate"><span class="pre">RTDETRConfig.num_classes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETR"><code class="docutils literal notranslate"><span class="pre">RTDETR</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETR.__init__"><code class="docutils literal notranslate"><span class="pre">RTDETR.__init__()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETR.forward"><code class="docutils literal notranslate"><span class="pre">RTDETR.forward()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETR.from_config"><code class="docutils literal notranslate"><span class="pre">RTDETR.from_config()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.RTDETR.load_checkpoint"><code class="docutils literal notranslate"><span class="pre">RTDETR.load_checkpoint()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.DETRPostProcessor"><code class="docutils literal notranslate"><span class="pre">DETRPostProcessor</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.rt_detr.DETRPostProcessor.forward"><code class="docutils literal notranslate"><span class="pre">DETRPostProcessor.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#image-segmentation">Image Segmentation</a><ul>
<li><a class="reference internal" href="#kornia.contrib.connected_components"><code class="docutils literal notranslate"><span class="pre">connected_components()</span></code></a></li>
<li><a class="reference internal" href="#segment-anything-sam">Segment Anything (SAM)</a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.sam.SamModelType"><code class="docutils literal notranslate"><span class="pre">SamModelType</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.sam.SamModelType.vit_h"><code class="docutils literal notranslate"><span class="pre">SamModelType.vit_h</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.sam.SamModelType.vit_l"><code class="docutils literal notranslate"><span class="pre">SamModelType.vit_l</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.sam.SamModelType.vit_b"><code class="docutils literal notranslate"><span class="pre">SamModelType.vit_b</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.sam.SamModelType.mobile_sam"><code class="docutils literal notranslate"><span class="pre">SamModelType.mobile_sam</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kornia.contrib.models.sam.SamConfig"><code class="docutils literal notranslate"><span class="pre">SamConfig</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.sam.SamConfig.checkpoint"><code class="docutils literal notranslate"><span class="pre">SamConfig.checkpoint</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.sam.SamConfig.encoder_depth"><code class="docutils literal notranslate"><span class="pre">SamConfig.encoder_depth</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.sam.SamConfig.encoder_embed_dim"><code class="docutils literal notranslate"><span class="pre">SamConfig.encoder_embed_dim</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.sam.SamConfig.encoder_global_attn_indexes"><code class="docutils literal notranslate"><span class="pre">SamConfig.encoder_global_attn_indexes</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.sam.SamConfig.encoder_num_heads"><code class="docutils literal notranslate"><span class="pre">SamConfig.encoder_num_heads</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.sam.SamConfig.model_type"><code class="docutils literal notranslate"><span class="pre">SamConfig.model_type</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.sam.SamConfig.pretrained"><code class="docutils literal notranslate"><span class="pre">SamConfig.pretrained</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kornia.contrib.models.sam.Sam"><code class="docutils literal notranslate"><span class="pre">Sam</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.models.sam.Sam.__init__"><code class="docutils literal notranslate"><span class="pre">Sam.__init__()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.sam.Sam.forward"><code class="docutils literal notranslate"><span class="pre">Sam.forward()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.sam.Sam.from_config"><code class="docutils literal notranslate"><span class="pre">Sam.from_config()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.models.sam.Sam.load_checkpoint"><code class="docutils literal notranslate"><span class="pre">Sam.load_checkpoint()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#image-patches">Image Patches</a><ul>
<li><a class="reference internal" href="#kornia.contrib.compute_padding"><code class="docutils literal notranslate"><span class="pre">compute_padding()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.extract_tensor_patches"><code class="docutils literal notranslate"><span class="pre">extract_tensor_patches()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.combine_tensor_patches"><code class="docutils literal notranslate"><span class="pre">combine_tensor_patches()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.ExtractTensorPatches"><code class="docutils literal notranslate"><span class="pre">ExtractTensorPatches</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.CombineTensorPatches"><code class="docutils literal notranslate"><span class="pre">CombineTensorPatches</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#image-classification">Image Classification</a><ul>
<li><a class="reference internal" href="#kornia.contrib.VisionTransformer"><code class="docutils literal notranslate"><span class="pre">VisionTransformer</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.VisionTransformer.forward"><code class="docutils literal notranslate"><span class="pre">VisionTransformer.forward()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.VisionTransformer.from_config"><code class="docutils literal notranslate"><span class="pre">VisionTransformer.from_config()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kornia.contrib.MobileViT"><code class="docutils literal notranslate"><span class="pre">MobileViT</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.TinyViT"><code class="docutils literal notranslate"><span class="pre">TinyViT</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.TinyViT.forward"><code class="docutils literal notranslate"><span class="pre">TinyViT.forward()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.TinyViT.from_config"><code class="docutils literal notranslate"><span class="pre">TinyViT.from_config()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kornia.contrib.ClassificationHead"><code class="docutils literal notranslate"><span class="pre">ClassificationHead</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#image-stitching">Image Stitching</a><ul>
<li><a class="reference internal" href="#kornia.contrib.ImageStitcher"><code class="docutils literal notranslate"><span class="pre">ImageStitcher</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#lambda">Lambda</a><ul>
<li><a class="reference internal" href="#kornia.contrib.Lambda"><code class="docutils literal notranslate"><span class="pre">Lambda</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#distance-transform">Distance Transform</a><ul>
<li><a class="reference internal" href="#kornia.contrib.distance_transform"><code class="docutils literal notranslate"><span class="pre">distance_transform()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.diamond_square"><code class="docutils literal notranslate"><span class="pre">diamond_square()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.DistanceTransform"><code class="docutils literal notranslate"><span class="pre">DistanceTransform</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kmeans">KMeans</a><ul>
<li><a class="reference internal" href="#kornia.contrib.KMeans"><code class="docutils literal notranslate"><span class="pre">KMeans</span></code></a><ul>
<li><a class="reference internal" href="#kornia.contrib.KMeans.fit"><code class="docutils literal notranslate"><span class="pre">KMeans.fit()</span></code></a></li>
<li><a class="reference internal" href="#kornia.contrib.KMeans.predict"><code class="docutils literal notranslate"><span class="pre">KMeans.predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=cce5339e"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/custom.js?v=107dad88"></script>
    <script defer="defer" type="module" src="https://gradio.s3-us-west-2.amazonaws.com/4.38.1/gradio.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/4.3.2/iframeResizer.min.js"></script>
    </body>
</html>